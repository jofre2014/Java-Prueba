gx.grid={drawAtServer:!1,deleteMethods:{images:0,menu:1,none:2},deletePositions:{left:0,right:1,bottomR:2,bottomL:3,topR:4,topL:5},deleteMethod:null,deleteImage:null,undeleteImage:null,deletePosition:null,deletePositionFree:null,deleteTooltip:null,deleteTitle:null,lastFocusCtrl:null,styles:{none:0,uniform:1,header:2,report:3},getImplClass:function(l,o){if(o){gx.lang.inherits(gx.ui.grid,gx.uc.UserControl,!0);gx.lang.inherits(gx.ui.grid,gx.grid.impl,!0);gx.lang.inherits(o,gx.ui.grid,!0);var g=new o;
l&&(g.ParentObject=l.parentObject,g.ControlName=l.gridName,l.parentObject.setUserControl(g));return g}return new gx.grid.impl("gx")},validGridColsValue:function(l){var o=l,o=void 0!=l?l:1;return 0!=o?o:9999},grid:function(l,o,g,t,s,B,C,v,D,E,F,G,w,H,I,x,J,K,L,M,y,N,z,O,P,Q,A,R,S,T){this.parentObject=l;this.gridLvl=o;this.gridLvlName=g;this.gridId=t;this.gridName=s;this.realGridName=B;this.containerName=C||this.gridName+"Container";this.parentName=E||"";this.pagingParms=[];this.lvlKey=F||[];this.isFreestyle=
G||!1;this.allowHovering=(this.allowSelection=H||!1)&&I||!1;this.allowCollapsing=S||!1;this.collapsed=!1;this.sortable=!0;this.hoverColor=this.selectionColor=null;this.visible=!0;this.refreshTimer=null;this.pageSizeParm=O||!1;this.hasAddlines=P||!1;this.hasForEachLine=Q||!1;this.width=void 0!=y?y:0;this.widthUnit=N||"";this.gridCols=void 0!=w?w:1;this.gridCols=0!=this.gridCols?this.gridCols:9999;this.gridRows=void 0!=x?x:5;this.usePaging=(this.usePaging=J||!1)&&!this.isFreestyle;this.eof=1;this.firstRecordOnPage=
0;this.defaultDragable=K||!1;this.defaultSetsContext=L||!1;this.boundedCollType=M||"";this.boundedCollName=T||"";this.gxContainerCtrl=this.contextMenu=null;this.lastRefreshParms="";this.gxComponentContext=v;this.isMasterPageGrid=D;this.htmlTags="";this.onLineActivate=R;this.addingRows=!1;this.deleteMethod=gx.grid.deleteMethod;this.DatePickersControls=[];this.GridUserControls=[];this.GridComponents=[];this.GridControls=[];this.implClass=A;this.grid=gx.grid.getImplClass(this,A);this.grid.ownerGrid=
this;this.grid.parentGxObject=this.parentObject;this.grid.gxLvl=this.gridLvl;this.grid.gxId=this.gridId;this.grid.gxGridName=this.gridName;this.grid.gxGridObject=this.containerName;this.grid.gxParentName=this.parentName;this.grid.gxIsFreestyle=this.isFreestyle;this.grid.gxWidth=this.width;this.grid.gxWidthUnit=this.widthUnit;this.grid.gxHeight=0;this.grid.gxAllowSelection=this.allowSelection;this.grid.gxAllowHovering=this.allowHovering;this.grid.gxAllowCollapsing=this.allowCollapsing;this.grid.gxCollapsed=
this.collapsed;this.grid.gxSortable=this.sortable;this.grid.gxSelectionColor=this.selectionColor;this.grid.gxHoverColor=this.hoverColor;this.grid.gxVisible=this.visible;this.grid.gxGridCols=this.gridCols;this.grid.gxCmpContext=this.gxComponentContext;this.grid.gxHtmlTags=this.htmlTags;this.grid.gxIsMasterPageGrid=this.isMasterPageGrid;this.grid.gxDragable=this.defaultDragable;this.grid.gxHasAddlines=this.hasAddlines;this.grid.gxHasForEachLine=this.hasForEachLine;this.grid.gxOnLineActivate=this.onLineActivate;
this.grid.gxNewRowText=void 0!=z?z:"New Row";this.currentBuffer=this.grid.gxBuffer;this.parentGrid=null;this.childGrids=[];this.hiddens=[];this.oldCmps={};this.ColumnPropertiesAfterRender=[];this.isUsercontrol=gx.lang.instanceOf(this.grid,gx.uc.UserControl);this.gxCreateGridCode=function(a){return new gx.grid.grid(this.parentObject,this.gridLvl,this.gridLvlName,this.gridId,this.gridName+"_"+a,this.gridName,this.containerName+"_"+a,this.gxComponentContext,this.isMasterPageGrid,this.parentName,this.lvlKey,
this.isFreestyle,this.gridCols,this.allowSelection,this.allowHovering,this.gridRows,this.usePaging,this.defaulDragable,this.defaulSetsContext,this.boundedCollType,this.width,this.widthUnit,this.grid.gxNewRowText,this.pageSizeParm,this.hasAddlines,this.hasForEachLine,this.implClass,this.onLineActivate,this.allowCollapsing)}.closure(this);this.gxAddColumnsCode=[];this.grid.usePaging=this.usePaging;this.grid.eof=this.eof;this.grid.firstRecordOnPage=this.firstRecordOnPage;this.postingVariables=[];this.addColumnDinCode=
function(a,b){this.gxAddColumnsCode.push(function(){a.apply(this,b)})};this.addSingleLineEdit=function(a,b,c,d,e,f,i,p,k,V,h,j,m,n,g,l,o,r,s,t){this.addColumnDinCode(this.addSingleLineEdit,arguments);var q=this.newColumn(d,i,j,p);q.visible=o;q.htmlName=c;q.gxId=b;q.gxAttId=a;q.gxAttName=f;q.gxTooltip=e;q.gxWidthUnit=k;q.gxColSize=h;q.gxSetsContext=s;q.gxControl=new gx.html.controls.singleLineEdit;q.gxControl.column=q;q.gxControl.isPassword=t;q.gxControl.visible=q.visible;q.gxControl.dataType=q.type;
q.gxControl.clickEvent=m;this.grid.addColumn(q)};this.addPostingVar=function(a){this.postingVariables.push(a)};this.addMultipleLineEdit=function(a,b,c,d,e,f,i,p,k,j,h,m,g,n,U,l,o){this.addColumnDinCode(this.addMultipleLineEdit,arguments);var r=this.newColumn(d,f,g,i);r.visible=U;r.htmlName=c;r.gxId=b;r.gxAttId=a;r.gxAttName=e;r.gxWidthUnit=p;r.gxSetsContext=l;r.gxControl=new gx.html.controls.multipleLineEdit;r.gxControl.column=r;r.gxControl.dataType=r.type;r.gxControl.visible=r.visible;r.gxControl.heightUnit=
j;r.gxControl.clickEvent=n;this.grid.addColumn(r)};this.addBlob=function(a,b,c,d,e,f,i,p,k,j,h,m,g){this.addColumnDinCode(this.addBlob,arguments);var n=this.newColumn(d,f,"left",k);n.visible=m;n.htmlName=c;n.gxId=b;n.gxAttId=a;n.gxAttName=e;n.gxWidthUnit=h;n.gxSetsContext=g;n.gxControl=new gx.html.controls.blob;n.gxControl.column=n;n.gxControl.dataType=n.type;n.gxControl.visible=n.visible;n.gxControl.height=p;n.gxControl.width=k;this.grid.addColumn(n)};this.addRadioButton=function(a,b,c,d,e,f,i,p,
k,j){this.addColumnDinCode(this.addRadioButton,arguments);var h=this.newColumn(d,f,"left","");h.visible=k;h.htmlName=c;h.gxId=b;h.gxAttId=a;h.gxAttName=e;h.gxSetsContext=j;h.gxControl=new gx.html.controls.radio;h.gxControl.column=h;h.gxControl.dataType=h.type;h.gxControl.vertical=p;h.gxControl.visible=h.visible;h.gxControl.clickEvent=i;this.grid.addColumn(h)};this.addComboBox=function(a,b,c,d,e,f,i,p,k,j,h,m){this.addColumnDinCode(this.addComboBox,arguments);var g=this.newColumn(d,f,"left",h);g.visible=
k;g.htmlName=c;g.gxId=b;g.gxAttId=a;g.gxAttName=e;g.gxSetsContext=j;g.gxWidthUnit=m;g.gxControl=new gx.html.controls.comboBox;g.gxControl.column=g;g.gxControl.dataType=g.type;g.gxControl.rtEnabled=1==p;g.gxControl.visible=g.visible;g.gxControl.clickEvent=i;this.grid.addColumn(g)};this.addListBox=function(a,b,c,d,e,f,i,p,k,g,h,j,m){this.addColumnDinCode(this.addListBox,arguments);var n=this.newColumn(d,f,"left",h);n.visible=k;n.htmlName=c;n.gxId=b;n.gxAttId=a;n.gxAttName=e;n.gxSetsContext=g;n.gxWidthUnit=
j;n.gxControl=new gx.html.controls.listBox;n.gxControl.column=n;n.gxControl.dataType=n.type;n.gxControl.rows="undefined"!=typeof m?m:4;n.gxControl.rtEnabled=1==p;n.gxControl.visible=n.visible;n.gxControl.clickEvent=i;this.grid.addColumn(n)};this.addCheckBox=function(a,b,c,d,e,f,i,p,k,g,h,j,m,n){this.addColumnDinCode(this.addCheckBox,arguments);var l=this.newColumn(d,i,"left",m);l.visible=h;l.htmlName=c;l.gxId=b;l.gxAttId=a;l.gxAttName=f;l.gxChecked=p;l.gxUnChecked=k;l.gxSetsContext=j;l.gxWidthUnit=
n;l.gxControl=new gx.html.controls.checkBox;l.gxControl.column=l;l.gxControl.checkedValue=p;l.gxControl.uncheckedValue=k;l.gxControl.dataType=l.type;l.gxControl.visible=l.visible;l.gxControl.clickEvent=g;this.grid.addColumn(l)};this.addBitmap=function(a,b,c,d,e,f,i,p,k,g){this.addColumnDinCode(this.addBitmap,arguments);var h=this.newColumn(g,"","left",d);h.htmlName=b;h.gxId=c;h.gxAttId=a;h.gxWidthUnit=e;h.gxControl=new gx.html.controls.image;h.gxControl.column=h;h.gxControl.dataType=h.type;h.gxControl.width=
d;h.gxControl.widthUnit=e;h.gxControl.height=f;h.gxControl.heightUnit=i;h.gxControl.clickEvent=p;this.grid.addColumn(h)};this.addVideo=function(a,b,c,d,e,f,i,p,k,g){this.addColumnDinCode(this.addVideo,arguments);var h=this.newColumn(g,"","left",d);h.htmlName=b;h.gxId=c;h.gxAttId=a;h.gxWidthUnit=e;h.gxControl=new gx.html.controls.video;h.gxControl.column=h;h.gxControl.dataType=h.type;h.gxControl.width=d;h.gxControl.widthUnit=e;h.gxControl.height=f;h.gxControl.heightUnit=i;h.gxControl.clickEvent=p;
this.grid.addColumn(h)};this.addAudio=function(a,b,c,d,e,f,i,p,k,g){this.addColumnDinCode(this.addAudio,arguments);var h=this.newColumn(g,"","left",d);h.htmlName=b;h.gxId=c;h.gxAttId=a;h.gxWidthUnit=e;h.gxControl=new gx.html.controls.audio;h.gxControl.column=h;h.gxControl.dataType=h.type;h.gxControl.width=d;h.gxControl.widthUnit=e;h.gxControl.height=f;h.gxControl.heightUnit=i;h.gxControl.clickEvent=p;this.grid.addColumn(h)};this.addTextBlock=function(a,b){this.addColumnDinCode(this.addTextBlock,arguments);
var c=this.newColumn("","","left");c.htmlName=a;c.gxControl=new gx.html.controls.textBlock;c.gxControl.column=c;c.gxControl.dataType=c.type;c.gxControl.clickEvent=b;this.grid.addColumn(c)};this.addButton=function(a,b,c,d,e){this.addColumnDinCode(this.addButton,arguments);var f=this.newColumn("","","left");f.htmlName=b;f.gxId=a;f.gxControl=new gx.html.controls.button;f.gxControl.column=f;f.gxControl.dataType=f.type;this.grid.addColumn(f)};this.addGrid=function(a){this.addColumnDinCode(this.addGrid,
arguments);this.childGrids.push(a);var b=this.newColumn("","","left");b.gxControl=new gx.html.controls.grid;b.gxControl.column=b;this.grid.addColumn(b)};this.addUsercontrol=function(a,b,c,d,e,f,i,p){this.addColumnDinCode(this.addUsercontrol,arguments);var k="",g=this.parentObject;g.GridUCsProps&&g.GridUCsProps[e]&&(k=g.GridUCsProps[e].title||"");k=this.newColumn(k,"","left");k.gxUCId=a;k.gxUCLastId=b;k.gxUCClassName=c;k.gxUCContainerName=d;k.gxUCControlName=e;k.gxShowFunc=f;k.gxC2VFuncs=i;k.gxV2CFuncs=
p;k.gxControl=new gx.html.controls.userControl;k.gxControl.column=k;k.gxControl.dataType=k.type;this.grid.addColumn(k)};this.startContainer=function(){this.addColumnDinCode(this.startContainer,arguments);var a=this.newColumn("","","left");a.gxControl=new gx.html.controls.userControlContainer;a.gxControl.column=a;a.gxControl.dataType=a.type;this.grid.addColumn(a)};this.endContainer=function(){this.addColumnDinCode(this.endContainer,arguments);this.currentBuffer.append("</div>")};this.addWebComponent=
function(a){this.addColumnDinCode(this.addWebComponent,arguments);var b=this.newColumn("","","left");b.gxControl=new gx.html.controls.webComponent;b.gxControl.column=b;b.gxControl.dataType=b.type;this.grid.addColumn(b)};this.addEmbeddedPage=function(a){this.addColumnDinCode(this.addEmbeddedPage,arguments);var b=this.newColumn("","","left");b.gxControl=new gx.html.controls.embeddedPage;b.gxControl.column=b;b.gxControl.dataType=b.type;this.grid.addColumn(b)};this.addHtmlCode=function(a){this.addColumnDinCode(this.addHtmlCode,
arguments);this.currentBuffer.append(a)};this.startTable=function(a,b,c){this.addColumnDinCode(this.startTable,arguments);var d=this.newColumn("","","left");d.htmlName=a+"_"+b;d.gxControl=new gx.html.controls.table;d.gxControl.column=d;d.gxControl.width=c;d.gxControl.dataType=d.type;this.grid.addColumn(d)};this.endTable=function(){this.addColumnDinCode(this.endTable,arguments);this.currentBuffer.append("</table>")};this.startRow=function(a,b,c,d,e,f){this.addColumnDinCode(this.startRow,arguments);
var i=this.newColumn("","","left");i.gxControl=new gx.html.controls.row;i.gxControl.column=i;i.gxControl.title=a;i.gxControl.align=b;i.gxControl.verticalAlign=c;i.gxControl.backColor=d;i.gxControl.borderColor=e;i.gxControl.cssClass=f;i.gxControl.ownCssClass=f;i.gxControl.dataType=i.type;this.grid.addColumn(i)};this.endRow=function(){this.addColumnDinCode(this.endRow,arguments);this.currentBuffer.append("</tr>")};this.startCell=function(a,b,c,d,e,f,i,g,k,j){this.addColumnDinCode(this.startCell,arguments);
var h=this.newColumn("","","left");h.gxControl=new gx.html.controls.cell;h.gxControl.column=h;h.gxControl.title=a;h.gxControl.align=b;h.gxControl.verticalAlign=c;h.gxControl.backColor=d;h.gxControl.borderColor=e;h.gxControl.height=f;h.gxControl.width=i;h.gxControl.colSpan=g;h.gxControl.rowSpan=k;h.gxControl.cssClass=j;h.gxControl.dataType=h.type;this.grid.addColumn(h)};this.endCell=function(){this.addColumnDinCode(this.endCell,arguments);this.currentBuffer.append("</td>")};this.startGroup=function(a,
b,c,d){this.addColumnDinCode(this.startGroup,arguments);var e=this.newColumn("","","left");e.htmlName=a;e.gxControl=new gx.html.controls.group;e.gxControl.column=e;e.gxControl.id=a;e.gxControl.caption=b;e.gxControl.height=c;e.gxControl.width=d;e.gxControl.dataType=e.type;this.grid.addColumn(e)};this.endGroup=function(){this.addColumnDinCode(this.endGroup,arguments);this.currentBuffer.append("</fieldset>")};this.startDiv=function(a,b,c,d){this.addColumnDinCode(this.startDiv,arguments);var e=this.newColumn("",
"","left");e.htmlName=a+"_"+b;e.gxControl=new gx.html.controls.div;e.gxControl.column=e;e.gxControl.width=d;e.gxControl.height=c;e.gxControl.dataType=e.type;this.grid.addColumn(e)};this.endDiv=function(){this.addColumnDinCode(this.endDiv,arguments);this.currentBuffer.append("</div>")};this.newColumn=function(a,b,c,d){b=this.getColumnType(b);a=new gx.grid.column(a,b,d,c);this.currentBuffer=a.buffer;a.htmlName="";a.gxId="";a.gxAttId="";a.gxAttName="";return a};this.getColumnType=function(a){switch(a){case "decimal":case "int":a=
gx.types.numeric;break;case "date":a=gx.types.date;break;case "dtime":a=gx.types.dateTime;break;case "boolean":a=gx.types.bool;break;case "Geolocation":a=gx.types.geolocation;break;default:a=gx.types.character}return a};this.addOldComponent=function(a,b){"undefined"==typeof this.oldCmps[a]&&(this.oldCmps[a]=[]);this.oldCmps[a].push(b)};this.updateOldComponents=function(){for(var a=this.grid.rows.length,b=0;b<a;b++)delete this.oldCmps[this.grid.rows[b].gxId];for(var c in this.oldCmps){for(a=this.oldCmps[c];0<
a.length;)b=a.shift(),gx.fn.deleteHidden(b);delete this.oldCmps[c]}};this.addHidden=function(a){this.hiddens.push(a)};this.addHiddenControl=function(a,b,c){gx.fn.setHidden(a,b);!0!=c&&this.addHidden(a)};this.clearHiddens=function(){for(;0<this.hiddens.length;){var a=this.hiddens.shift();gx.fn.deleteHidden(a)}};var m={};this.setHtmlTags=function(a){gx.lang.apply(m,a);var b;b=' style="'+("0"==m.Visible?"display:none;":"");var a=""+(' class="'+m.Class+'"'),c=gx.lang.emptyObject;b+=!c(m.Background)?"background:"+
m.Background+";":"";b+=!c(m.Backcolor)&&"0"!=m.Backcolor?"background-color:"+gx.color.html(m.Backcolor).Html+";":"";b+=!c(m.Bordercolor)&&"0"!=m.Bordercolor?"border-color:"+gx.color.html(m.Bordercolor).Html+";":"";a+=!c(m.Align)?' align="'+m.Align+'"':"";a+=!c(m.Tooltiptext)?' title="'+m.Tooltiptext+'"':"";b+=!c(m.Borderwidth)&&"0"!=m.Borderwidth?" border-width:"+m.Borderwidth+";":"";a+=!c(m.Cellpadding)?' cellpadding="'+m.Cellpadding+'"':"";a+=!c(m.Cellspacing)?' cellspacing="'+m.Cellspacing+'"':
"";a+=!c(m.Height)&&"0"!=m.Height?' height="'+m.Height+'"':"";a+=!c(m.Width)&&"0"!=m.Width?' width="'+m.Width+'"':"";this.htmlTags=gx.text.trim(a+(b+'"'));this.grid.gxHtmlTags=this.htmlTags;c(m.Width)||(this.grid.gxWidth=m.Width);c(m.Height)||(this.grid.gxHeight=m.Height)};var j={};this.setGridStyles=function(a){gx.lang.apply(j,a);this.visible=void 0!=j.Visible?gx.lang.gxBoolean(j.Visible):!0;this.setSortable(void 0!=j.Sortable?gx.lang.gxBoolean(j.Sortable):!0);this.background=void 0!=j.Background?
j.Background:"";this.cssClass=void 0!=j.Class?j.Class:"";this.titleBackstyle=void 0!=j.Backcolorstyle?j.Backcolorstyle:gx.grid.styles.none;this.titleFont=void 0!=j.Titlefont?j.Titlefont:"";this.linesFont=void 0!=j.Linesfont?j.Linesfont:"";this.borderWidth=void 0!=j.Borderwidth?j.Borderwidth:"";this.toolTipText=void 0!=j.Tooltiptext?j.Tooltiptext:"";try{this.backcolor=void 0!=j.Backcolor?gx.color.html(j.Backcolor).Html:"",this.titleBackcolor=void 0!=j.Titlebackcolor?gx.color.html(j.Titlebackcolor).Html:
"",this.titleForecolor=void 0!=j.Titleforecolor?gx.color.html(j.Titleforecolor).Html:"",this.linesBackcolorOdd=void 0!=j.Backcolorodd?gx.color.html(j.Backcolorodd).Html:"",this.linesBackcolorEven=void 0!=j.Backcoloreven?gx.color.html(j.Backcoloreven).Html:"",this.bordercolor=void 0!=j.Bordercolor?gx.color.html(j.Bordercolor).Html:""}catch(b){gx.dbg.logEx(b,"gxgrid.js","setGridStyles")}this.borderWidth=void 0!=j.Borderwidth?j.Borderwidth:"";this.toolTipText=void 0!=j.Tooltiptext?j.Tooltiptext:"";this.grid.gxCssClass=
"";this.grid.gxTitleClass="";this.grid.gxFooterClass="";this.grid.gxOddLlinesClass="";this.grid.gxEvenLinesClass="";this.grid.gxBackColor=this.backcolor;this.grid.gxTitleBackColor=this.titleBackcolor;this.grid.gxTitleForeColor=this.titleForecolor;this.grid.gxTitleBackstyle=this.titleBackstyle;this.grid.gxTitleFont=this.titleFont;this.grid.gxLinesFont=this.linesFont;this.grid.gxBackground=this.background;this.grid.gxLinesBackcolorOdd=this.linesBackcolorOdd;this.grid.gxLinesBackcolorEven=this.linesBackcolorEven;
this.grid.gxBorderWidth=this.borderWidth;this.grid.gxBordercolor=this.bordercolor;this.grid.gxToolTipText=this.toolTipText;this.grid.gxVisible=this.visible;""!=this.cssClass&&(this.grid.gxCssClass=this.cssClass,this.grid.gxTitleClass=this.cssClass+"Title",this.grid.gxFooterClass=this.cssClass+"Footer",this.titleBackstyle==gx.grid.styles.none?(this.grid.gxOddLlinesClass=this.cssClass+"Odd",this.grid.gxEvenLinesClass=this.grid.gxOddLlinesClass):this.titleBackstyle==gx.grid.styles.uniform?(this.grid.gxOddLlinesClass=
this.cssClass+"Uniform",this.grid.gxEvenLinesClass=this.grid.gxOddLlinesClass):this.titleBackstyle==gx.grid.styles.header?(this.grid.gxOddLlinesClass=this.cssClass+"Odd",this.grid.gxEvenLinesClass=this.grid.gxOddLlinesClass):this.titleBackstyle==gx.grid.styles.report&&(this.isFreestyle&&0>=this.gridCols?(this.grid.gxOddLlinesClass=this.cssClass+"Odd",this.grid.gxEvenLinesClass=this.grid.gxOddLlinesClass):(this.grid.gxOddLlinesClass=this.cssClass+"Odd",this.grid.gxEvenLinesClass=this.cssClass+"Even")))};
this.setSortable=function(a){if(this.sortable!=a){this.sortable=a;for(var b=this.grid.columns.length,c=0;c<b;c++)this.grid.columns[c].sortable=a}};this.lastRowId=0;this.addRow=function(a){var b,c,d,e=this.lastRowId++,f=gx.grid.rowId(e+1),f=new gx.grid.row(e,a,f,this.grid.gxParentRowId);f.gxCmpContext=this.gxComponentContext;f.Grids=a.Grids;f.ownerGrid=this;f.gxLvl=this.gridLvl;this.setRowHiddens(a.Hiddens);var i=this.grid.columns,g;g=i.length;for(var k=0;k<g;k++){var j=i[k];if(0!==e){d=this.grid.rows[0].gxProps[k];
b=a.Props[k].length;for(c=this.grid.rowsValues?d.length-1:d.length;b<c;b++)f.gxProps[k].push(d[b])}d=a.Props[k];c=d[d.length-1];this.grid.rowsValues&&!this.autoRefreshing?void 0!==this.grid.rowsValues[e]&&(c=this.grid.rowsValues[e][k]):c=d[d.length-1];f.values[k]=c;this.grid.rowsValues&&f.gxProps[k].push(c);this.parentObject.isTransaction()&&(j=this.columnIndexInKey(j.gxAttId),-1!=j&&(f.gxKeyValues[j]=c))}this.isFreestyle&&(f.IsNew=!0,this.installChildGrids(f));this.grid.addRow(f);return f};this.installChildGrids=
function(a){for(var b=this.childGrids.length,c=0;c<b;c++){var d=this.childGrids[c],e=d.gxCreateGridCode(a.gxId);e.grid.parentGxObject=this.parentObject;var f=(!e.isMasterPageGrid?this.grid.gxCmpContext:"MP")+e.realGridName+"Container";e.gxContainerDivName=f+"Div_"+a.gxId;e.gxContainerDataName=f+"Data_"+a.gxId;e.gxContainerValuesName=f+"DataV_"+a.gxId;a.gxGrids.push(e);e.parentGrid=this;e.parentRow=a;this.parentObject.setGrid(e);d.copyPropertiesTo(e);e.grid.gxCmpContext=this.grid.gxCmpContext;e.grid.gxParentRowId=
a.gxId;this.installChildGridColumns(e,d)}};this.installChildGridColumns=function(a,b){for(var c=b.gxAddColumnsCode.length,d=0;d<c;d++)b.gxAddColumnsCode[d].call(a)};this.copyPropertiesTo=function(a){a.cssClass=this.cssClass;a.titleBackstyle=this.titleBackstyle;a.titleBackcolor=this.titleBackcolor;a.linesBackcolorOdd=this.linesBackcolorOdd;a.linesBackcolorEven=this.linesBackcolorEven;a.grid.gxCssClass=this.grid.gxCssClass;a.grid.gxTitleClass=this.grid.gxTitleClass;a.grid.gxOddLlinesClass=this.grid.gxOddLlinesClass;
a.grid.gxEvenLinesClass=this.grid.gxEvenLinesClass;a.grid.gxAllowCollapsing=this.grid.gxAllowCollapsing;a.grid.gxCollapsed=this.grid.gxCollapsed};this.setRowHiddens=function(a){if(a&&this.parentObject.isTransaction())for(var b in a)gx.fn.setHidden(b,a[b])};this.executeEvent=function(a,b){gx.evt.setGridEvt(this.gridId.toString(),b);this.instanciateRow(b);this.parentObject[a].call(this.parentObject,b)};this.updatePagingVars=function(a,b){this.grid.usePaging&&(void 0==a&&void 0==b?(this.grid.eof=gx.fn.getHidden(this.grid.gxCmpContext+
this.grid.gxGridName.toUpperCase()+"_nEOF"),this.grid.firstRecordOnPage=gx.fn.getHidden(this.grid.gxCmpContext+this.grid.gxGridName.toUpperCase()+"_nFirstRecordOnPage")):(this.grid.eof=a,this.grid.firstRecordOnPage=b))};this.setPagingVars=function(a,b){this.grid.eof=a;this.grid.firstRecordOnPage=b;var c=this.grid.gxGridName.toUpperCase(),d=this.grid.gxCmpContext;gx.fn.setHidden(d+c+"_nEOF",a);gx.fn.setHidden(d+c+"_nFirstRecordOnPage",b)};this.clearDefaultEventHandlers=function(){var a=0;if(this.defaultDragable||
this.defaultSetsContext)for(var a=this.grid.rows.length,b=0;b<a;b++){var c=this.containerName+"Row_"+this.grid.rows[b].gxId;this.defaultDragable&&gx.fx.dnd.deleteSource(c);this.defaultSetsContext&&gx.fx.ctx.deleteSetter(c)}a=this.grid.columns.length;for(b=0;b<a;b++)if(c=this.grid.columns[b],!0==c.gxSetsContext)for(var d=this.grid.rows.length,e=0;e<d;e++)gx.fx.ctx.deleteSetter(c.htmlName+"_"+this.grid.rows[e].gxId)};this.setDefaultEventHandlers=function(){var a=0;if(this.defaultDragable||this.defaultSetsContext)if(gx.lang.emptyObject(this.boundedCollType))for(var b=
this.getRowAsTypes(),a=this.grid.rows.length,c=0;c<a;c++){var d=this.gxComponentContext+this.containerName+"Row_"+this.grid.rows[c].gxId,e=gx.dom.el(d);null!=e&&(e.gxGrid=this.containerName,e.gxGridName=this.gridName,e.gxId=this.grid.rows[c].gxId);d=this.containerName+"Row_"+this.grid.rows[c].gxId;e=function(a){return this.returnRowData(a)}.closure(this);this.defaultDragable&&gx.fx.dnd.addSource(this.parentObject,d,this.cssClass,b,e);this.defaultSetsContext&&gx.fx.ctx.addSetter(this.parentObject,
d,this.cssClass,b,e)}else a=this.grid.gxCmpContext+this.containerName+"Div",e=function(){return this.returnGridData()}.closure(this),this.defaultDragable&&gx.fx.dnd.addSource(this.parentObject,a,this.cssClass,[this.boundedCollType],e),this.defaultSetsContext&&gx.fx.ctx.addSetter(this.parentObject,a,this.cssClass,[this.boundedCollType],e);a=this.grid.columns.length;for(c=0;c<a;c++)if(b=this.grid.columns[c],!0==b.gxSetsContext){e=this.grid.rows.length;for(d=0;d<e;d++){var f=gx.dom.el(this.gxComponentContext+
b.htmlName+"_"+this.grid.rows[d].gxId);null!=f&&(f.gxHtmlName=b.htmlName,gx.fx.ctx.addSetter(this.parentObject,b.htmlName+"_"+this.grid.rows[d].gxId,"",[b.gxAttName],this.returnColumnContext))}}};this.returnColumnContext=function(a){var b="",b="SPAN"==a.nodeName?gx.dom.spanValue(a):gx.fn.getControlValue_impl(a.id);return null!=b?b:""};this.returnRowData=function(a){var b={};if(a=this.grid.getRowByGxId(a.gxId))for(var c=this.grid.columns.length,d=0;d<c;d++){var e=this.grid.columns[d].gxAttName;""!=
e&&(b[e]=a.values[d])}return b};this.returnGridData=function(){for(var a=[],b=this.grid.rows.length,c=0;c<b;c++){var d={};a[c]=d;for(var e=this.grid.rows[c],f=this.grid.columns.length,i=0;i<f;i++){var g=this.grid.columns[i].gxAttName;""!=g&&(d[g]=e.values[i])}}return a};this.doDrop=function(a){this.getNewRows(void 0!=a.length?ropObj.length:1,null,function(b){this.addDropedRows(b,a)})};this.addDropedRows=function(a,b){var c=b.length;if(void 0!=c)for(var d=0;d<c;d++)this.setDroppedRow(a[d],b[d]);else this.setDroppedRow(a[0],
b);this.setNewRows(a)};this.setDroppedRow=function(a,b){for(var c=this.grid.columns.length,d=0;d<c;d++){var e=a.Props[d],f=this.grid.columns[d].gxAttName,i="";""!=f&&void 0!=b[f]&&(i=b[f]);e.Value=i;e.FormattedValue=i}};this.getRowAsTypes=function(){for(var a=[],b=this.grid.columns.length,c=0;c<b;c++){var d=this.grid.columns[c].gxAttName;""!=d&&a.push(d)}return a};this.addRows=function(a){var b=a.Count;this.grid.rowsValues=a.values;for(var c=0;c<b;c++)this.addRow(a[c])};this.lastRowIsModified=function(){if(0==
this.grid.rows.length)return!1;var a=this.grid.rows[this.grid.rows.length-1];return a.gxExists()||a.gxIsMod()?!0:!1};this.getNewRows=function(a,b,c){var c=void 0!=c?c:this.setNewRows,d=gx.util.browser.isFirefox()?"keypress":"keydown";null==b||(b.type==d&&(32==b.charCode||32==b.keyCode||13==b.keyCode)||"click"==b.type)&&(0==this.grid.rows.length||this.lastRowIsModified())?(gx.csv.pkDirty=!1,gx.ajax.newRows(this.gxComponentContext,this.isMasterPageGrid,this.realGridName,a+this.lastRowId,this.lastRowId+
1,gx.grid.rowId(this.lastRowId+1)+this.grid.gxParentRowId,this.grid.gxParentRowId,c),gx.csv.pkDirty=!1,null!=b&&gx.evt.cancel(b,!0)):null!=b&&(32==b.keyCode||13==b.keyCode)&&gx.evt.cancel(b,!0)};this.setNewRows=function(a){if(void 0!=a.Count){for(var b=0,b=0;b<a.Count;b++){var c=this.addRow(a[b]);gx.fn.setCurrentGridRow(this.gridId,c.gxId)}0<a.Count&&(this.addingRows=!0,this.refreshGrid(!1),this.addingRows=!1,this.setFocusFirstControl(a[0]))}};this.gxNewRowFocused=function(a){a.style.textDecoration=
"underline";var b=gx.fn.firstGridControl(this.gridId);gx.evt.onfocus(a,b,this.gxComponentContext,this.isMasterPageGrid,"9999",this.gridId)};this.rowKeyPressed=function(a){var b=gx.evt.source(a);void 0!=b&&(a.ctrlKey&&46==a.keyCode)&&(this.setRowDeleted(b),gx.evt.cancel(a,!0))};this.gxHasDuplicateKey=function(){for(var a=[],b=this.grid.rows,c=b.length,d=0;d<c;d++){var e=b[d];if((e.gxExists()||e.gxIsMod())&&!e.gxDeleted()){for(var f="",i=e.gxKeyValues.length,g=0;g<i;g++)f+=e.gxKeyValues[g].toString();
if(void 0!=a[f])return!0;a[f]=1}}return!1};this.columnIndexInKey=function(a){for(var b=this.lvlKey.length,c=0;c<b;c++)if(this.lvlKey[c]==a)return c;return-1};this.refreshVars=[];this.addRefreshingVar=function(a){if(!gx.lang.emptyObject(a)){var b="";this.refreshVars[this.refreshVars.length]=a;if(a.fld){var c=gx.dom.el(this.gxComponentContext+a.fld);if(void 0!=c&&gx.lang.emptyObject(a.hc)&&("radio"==c.type||"checkbox"==c.type&&gx.util.browser.isIE()&&8>=gx.util.browser.ieVersion()?b="click":"SELECT"==
c.tagName||"checkbox"==c.type?b="change":gx.lang.isNumericType(a.type)?gx.lang.isNumericType(a.type)&&(b="blur"):b=["keyup","input"],""!=b))if("radio"==c.type)for(var a=gx.dom.byName(this.gxComponentContext+a.fld),c=a.length,d=0;d<c;d++)gx.evt.attach(a[d],b,function(){this.filterVarChanged()},this);else"search"==c.type&&(b=[b,"search"]),gx.evt.attach(c,b,function(){this.filterVarChanged()},this)}}};this.filterVarChanged=function(){if(this.parentObject.autoRefresh&&!gx.grid.drawAtServer){var a=this.getRefreshParmsUrl();
this.lastRefreshParms!=a&&(this.lastRefreshParms=a,this.callAsyncRefresh(a))}else this.parentObject.conditionsChanged=this.conditionsChanged()};this.conditionsChanged=function(){for(var a=this.refreshVars.length,b=0;b<a;b++){var c=this.refreshVars[b];if("undefined"==typeof c.rfrVar){var d=gx.fn.getHidden(this.gxComponentContext+"GXH_"+c.fld),c=c.val();if(d!=c)return!0}}return!1};this.getRefreshParmsUrl=function(){var a="";this.pageSizeParm&&(a=this.grid.pageSize+",");for(var b=this.refreshVars.length,
c=0;c<b;c++){var d=this.refreshVars[c];if("undefined"!=typeof d.rfrVar){var e=void 0,f=void 0;if("undefined"!=typeof d.rfrProp){var i;"undefined"!=typeof d.gxAttId&&(i=this.grid.getColumnByGxAttId(d.gxAttId));i||(i=this.grid.getColumnForVar(d.rfrVar));i?(d=d.rfrProp.toLowerCase(),e=i[d],"value"==d&&i.gxControl.type==gx.html.controls.types.image&&(e=gx.util.removeBaseUrl(e))):e=""}else"undefined"!=typeof this.parentObject.VarControlMap[d.rfrVar]&&(f=this.parentObject.VarControlMap[d.rfrVar].id),"undefined"!=
typeof f&&(e=gx.fn.getHidden(this.gxComponentContext+f)),"undefined"==typeof e&&(e=this.parentObject[d.rfrVar]),"object"==typeof e&&(e=gx.json.serializeJson(e));a+=encodeURIComponent(e)+","}else a=gx.lang.emptyObject(d.hc)?a+(this.getFormattedParm(d)+","):a+(encodeURIComponent(this.parentObject[d.hc])+","),gx.fn.setHidden(this.gxComponentContext+"GXH_"+d.fld,d.val())}this.parentObject.IsComponent&&(a+=encodeURIComponent(this.parentObject.CmpContext)+",");return a};this.initRefreshParms=function(){this.parentObject.autoRefresh&&
(this.lastRefreshParms=this.getRefreshParmsUrl())};this.getFormattedParm=function(a){return"date"==a.type?(a=gx.dom.el(this.gxComponentContext+a.fld),encodeURIComponent(gx.date.urlDate(a,gx.dateFormat))):"dtime"==a.type?(a=gx.dom.el(this.gxComponentContext+a.fld),encodeURIComponent(gx.date.urlDateTime(a,gx.dateFormat))):encodeURIComponent(a.val())};this.callAsyncRefresh=function(a){gx.evt.refreshGridCallback||(gx.evt.refreshGridCallback=[]);null!=this.refreshTimer&&(window.clearTimeout(this.refreshTimer),
this.refreshTimer=null,gx.evt.setReady(!0));gx.evt.setReady(!1);this.refreshTimer=window.setTimeout(function(){gx.ajax.refreshGrid(this,a);gx.evt.setReady(true);gx.evt.notifyRefreshGrid()}.closure(this),400)};this.updatePropsHidden=function(a){var b=this.getDataHiddenName();gx.fn.setHidden(b,a)};this.updatePagingVarsAfterRefresh=function(a){if(this.usePaging){var b=this.grid.gxGridName.toUpperCase()+"_nEOF",c=this.grid.gxGridName.toUpperCase()+"_nFirstRecordOnPage";this.setPagingVars(a[b],a[c])}};
this.getSelection=function(){if(this.allowSelection)for(var a=this.grid.rows.length,b=0;b<a;b++)if(this.grid.rows[b].selected)return b;return-1};this.setSelection=function(a){if(this.allowSelection&&0<=a){var a=gx.grid.rowId(a+1),b=gx.dom.el(this.grid.gxCmpContext+this.grid.gxGridObject+"Row_"+a);b&&this.grid.setRowSelected(b,a)}};this.blankGridRows=function(){this.lastRowId=0;this.grid.rows=[];delete this.grid.rowsValues};this.setRowDeleted=function(a){var b=null,b="string"==typeof a?this.grid.getRowByGxId(a):
void 0==a.gxId?this.getRowFromHtmlCtrl(a):a;b.setDeleted(!b.gxDeleted());this.setRowModified(b.gxId);gx.fn.removeGridRow(b.gxId,this.gridId.toString());this.refreshGrid(!1)};this.setFocusFirstControl=function(a){for(var b=0;b<a.Count;b++){var c=this.grid.getRowByGxId(gx.grid.rowId(this.lastRowId)+this.grid.gxParentRowId);if(c&&(c=gx.dom.el(this.grid.gxCmpContext+this.grid.columns[b].htmlName+"_"+c.gxId),void 0!=c&&gx.fn.isAccepted(c))){gx.grid.lastFocusCtrl=this.grid.columns[b].gxId;gx.fn.setFocus(c);
break}}};this.instanciateRow=function(a){var b=gx.O;gx.setGxO(this.parentObject.CmpContext,this.parentObject.IsMasterPage);try{var c=a;"string"==typeof c&&(c=this.grid.getRowByGxId(a));if(null!=c){gx.fn.setCurrentGridRow(this.gridId,c.gxId);for(var d=c.values.length,e=0;e<d;e++){var f=this.grid.columns[e];if(""!=f.gxId){var i=this.parentObject.getValidStruct(f.gxId);i&&(this.isUsercontrol?i.v2v&&(i.v2v(this.grid.properties[c.id][f.index].value),gx.fn.setHidden(this.grid.properties[c.id][f.index].id,
this.grid.properties[c.id][f.index].value)):"function"==typeof i.c2v&&i.c2v())}}}else{gx.fn.setCurrentGridRow(this.gridId,a);d=this.grid.columns.length;for(e=0;e<d;e++)f=this.grid.columns[e],""!=f.gxId&&(i=this.parentObject.getValidStruct(f.gxId))&&"function"==typeof i.c2v&&i.c2v()}}catch(g){gx.dbg.logEx(g,"gxgrid.js","instanciateRow")}gx.setGxO(b.CmpContext,b.IsMasterPage);return!0};this.setRenderProp=function(a,b,c,d){this.grid.setProp(a,b,c,d)};this.setRenderDynProp=function(a,b,c,d){this.grid.setDynProp(a,
b,c,d)};this.addRenderEventHandler=function(a,b){this.grid.addEventHandler(a,b)};this.cleanup=function(){this.parentGrid=this.parentObject=null;this.grid.ownerGrid=null;this.grid.parentGxObject=null;this.grid.container=null;this.grid.ascLabel=null;this.grid.descLabel=null;this.grid.columns=null;this.grid=this.grid.rows=null};this.loadGrid=function(a,b){gx.dbg.logPerf("loadGrid_"+this.gridName);var c=gx.O;gx.setGxO(this.parentObject.CmpContext,this.parentObject.IsMasterPage);this.isLoading=!0;var d=
this.parentObject.isTransaction();d&&null==this.contextMenu&&(this.contextMenu=new gx.grid.contextMenu(this));void 0!=a?(d=this.getContainerControl(),null!=d&&(!0==b&&(a.values=this.getValuesFromHidden(),this.isFreestyle&&gx.lang.emptyObject(this.parentRow)&&this.backupComponents()),this.deleteGridData(),this.grid.setContainerDelayed(d),this.clearHiddens(),this.setRowsProperty(),d=this.getSelection(),this.blankGridRows(),this.setHtmlTags(a),this.setGridStyles(a),this.setDeleteMethod(a.DeleteMethod),
this.setSelectionAndHover(a.Allowselection,a.Selectioncolor,a.Allowhover,a.Hovercolor),this.setCollapsing(a.Allowcollapsing,a.Collapsed),this.setSflColumns(a.SflColumns),this.setColumnsProperties(a.Columns),this.autoRefreshing?this.updatePagingVarsAfterRefresh(a):this.updatePagingVars(),this.addRows(a),this.updateOldComponents(),this.initRefreshParms(),this.refreshGrid(null,this.autoRefreshing),this.setSelection(d))):(this.clearHiddens(),this.setRowsProperty(),this.grid.pageSize=d||this.isFreestyle?
9999:this.gridRows,d=this.getContainerControl(),null!=d?(this.grid.setContainerDelayed(d),d=this.getRowsFromHidden(),null!=d?(d.values=this.getValuesFromHidden(),this.blankGridRows(),this.setHtmlTags(d),this.setGridStyles(d),this.setDeleteMethod(d.DeleteMethod),this.setSelectionAndHover(d.Allowselection,d.Selectioncolor,d.Allowhover,d.Hovercolor),this.setCollapsing(d.Allowcollapsing,d.Collapsed),this.setSflColumns(d.SflColumns),this.setColumnsProperties(d.Columns),this.updatePagingVars(),this.addRows(d),
this.initRefreshParms(),this.addingRows=!0,this.refreshGrid(),this.addingRows=!1):(this.blankGridRows(),this.updatePagingVars(),this.initRefreshParms(),this.refreshGrid())):this.loadWrappedGridChilds());this.isLoading=!1;gx.setGxO(c.CmpContext,c.IsMasterPage);gx.dbg.logPerf("loadGrid_"+this.gridName,"Grid '"+this.gridName+"' loaded")};this.loadWrappedGridChilds=function(){try{var a=gx.fn.getHidden(this.grid.gxCmpContext+"nRC_"+this.gridName);if("undefined"!=typeof a){for(var a=parseInt(a),b=0;b<a;b++)for(var c=
this.grid.columns.length,d=0;d<c;d++){var e=this.grid.columns[d];e.gxControl.type==gx.html.controls.types.userControl&&this.addUsercontrolToDraw({r:gx.grid.rowId(b+1),c:e})}this.setupGridUsercontrols(this.GridUserControls)}}catch(f){gx.dbg.logEx(f,"gxgrid.js","loadWrappedGridChilds")}};this.getRowsFromHidden=function(){var a=this.getDataHiddenName(),b=gx.fn.getHidden(a),c=null;if(gx.lang.emptyObject(b))return null;gx.json.setNonSerializable(a);return c=gx.json.evalJSON(b)};this.deleteGridData=function(){var a=
this.getDataHiddenName();gx.json.setNonSerializable(a)};this.getValuesFromHidden=function(){var a=this.getValuesHiddenName(),b=gx.fn.getHidden(a);gx.lang.emptyObject(b)&&(b=gx.fn.getControlValue(a));gx.json.setNonSerializable(a);a=null;null!=b&&""!=b&&(a=gx.json.evalJSON(b));return a};this.getContainerControl=function(){var a=null;if(a=void 0!=this.gxContainerDivName?gx.dom.byId(this.gxContainerDivName):gx.dom.byId(this.grid.gxCmpContext+this.containerName+"Div"))this.gxContainerCtrl=a,a.setAttribute("gxgridid",
this.gridId.toString()),a.gxGridName=this.grid.gxGridName;return a};this.getDataHiddenName=function(){var a=""==this.grid.gxParentRowId?"":"_"+this.grid.gxParentRowId,b="";return b=void 0!=this.gxContainerDataName?this.gxContainerDataName:this.grid.gxCmpContext+this.containerName+"Data"+a};this.getValuesHiddenName=function(){var a=""==this.grid.gxParentRowId?"":"_"+this.grid.gxParentRowId,b="";return b=void 0!=this.gxContainerValuesName?this.gxContainerValuesName:this.grid.gxCmpContext+this.containerName+
"DataV"+a};this.setColumnsProperties=function(a){try{for(var b=a.length,c=0;c<b;c++){var d=this.grid.columns[c],e;for(e in a[c]){var f=a[c][e];e=this.fixColumnPropName(e);this.isUsercontrol&&(d[e]=f);d[e.toLowerCase()]=f}this.checkPromptColumn(d)}}catch(i){gx.dbg.logEx(i,"gxgrid.js","setColumnsProperties")}};this.checkPromptColumn=function(a){try{if(this.isPromptColumn(a)){var b=gx.fn.getAttachedCtrl(a.htmlName);if(b&&b.info&&b.info.controls){for(var c=!1,d=!1,e=b.info.controls.length,f=0;f<e;f++){var i=
this.grid.getColumnByGxId(b.info.controls[f]),g=gx.lang.gxBoolean(i.enabled),k=gx.lang.gxBoolean(i.visible);g&&(d=!0);k&&(c=!0)}d||(a.enabled="0");c||(a.visible="0")}}}catch(j){gx.dbg.logEx(j,"gxgrid.js","checkPromptColumn")}};this.fixColumnPropName=function(a){return"Horizontalalignment"==a?"align":a};this.setDeleteMethod=function(a){if(this.parentObject.isTransaction()){var b="DSP"==this.parentObject.Gx_mode;!b&&(a&&"none"==a)&&(b=!0);this.deleteMethod=b?gx.grid.deleteMethods.none:gx.grid.deleteMethod}};
this.setSelectionAndHover=function(a,b,c,d){try{this.allowSelection=gx.lang.gxBoolean(a),this.hoverColor=this.selectionColor=null,this.allowSelection&&(this.allowHovering=gx.lang.gxBoolean(c),b=eval(b),this.selectionColor="undefined"!=typeof b[0]?gx.color.fromRGB(b[0],b[1],b[2]):gx.color.html(b),this.allowHovering&&(d=eval(d),this.hoverColor="undefined"!=typeof d[0]?gx.color.fromRGB(d[0],d[1],d[2]):gx.color.html(d))),this.grid.gxAllowSelection=this.allowSelection,this.grid.gxSelectionColor=this.selectionColor,
this.grid.gxAllowHovering=this.allowHovering,this.grid.gxHoverColor=this.hoverColor}catch(e){gx.dbg.logEx(e,"gxgrid.js","setSelectionAndHover")}};this.setCollapsing=function(a,b){try{this.allowCollapsing=gx.lang.gxBoolean(a),this.collapsed=gx.lang.gxBoolean(b),this.grid.gxAllowCollapsing=this.allowCollapsing,this.grid.gxCollapsed=this.collapsed}catch(c){gx.dbg.logEx(c,"gxgrid.js","setCollapsing")}};this.setSflColumns=function(a){try{if(!gx.lang.emptyObject(a)||0===a)this.gridCols=gx.grid.validGridColsValue(parseInt(a)),
this.grid.gxGridCols=this.gridCols,1<this.gridCols&&0<this.gridRows&&(this.grid.pageSize=(this.gridRows?this.gridRows:1)*this.gridCols)}catch(b){gx.dbg.logEx(b,"gxgrid.js","setSflColumns")}};this.isPromptColumn=function(a){return a.gxAttId.indexOf&&-1!=a.gxAttId.indexOf("prompt_")?!0:!1};this.setRowsProperty=function(){var a=gx.fn.getHidden(this.grid.gxCmpContext+this.gridName.toUpperCase()+"_Rows");if(null!=a){try{this.gridRows=parseInt(a,10)}catch(b){gx.dbg.logEx(b,"gxgrid.js","setRowsProperty")}this.grid.pageSize=
this.gridRows*(1<this.gridCols?this.gridCols:1)}};this.crearInstalledSuggests=function(){for(var a=this.grid.columns.length,b=0;b<a;b++){var c=this.parentObject.getValidStruct(this.grid.columns[b].gxId);c&&(c.gxsgprm&&c.gxsgprm.installed)&&(c.gxsgprm.installed={})}};this.refreshCollection=function(a){try{this.blankGridRows();this.updatePagingVars();this.initRefreshParms();for(var b=a.length,c=0;c<b;c++){for(var d={Props:[]},e=a[c],f=this.grid.columns.length,i=0;i<f;i++){var g=this.grid.columns[i];
d.Props[g.index]=[e[g.gxAttName]]}this.addRow(d)}this.refreshGrid(!1,!1,!0)}catch(k){gx.dbg.logEx(k,"gxgrid.js","refreshCollection")}};this.refreshGrid=function(a,b,c){this.DatePickersControls=[];this.GridUserControls=[];this.GridComponents=[];this.GridControls=[];this.clearDefaultEventHandlers();this.clearHiddens();this.crearInstalledSuggests();this.setRowsProperty();if(void 0!=this.parentRow&&!gx.lang.emptyObj(this.parentRow.Grids)){var d=this.parentRow.Grids[this.realGridName];null!=d&&(this.setHtmlTags(d),
this.setGridStyles(d),this.setColumnsProperties(d.Columns),this.addingRows||this.parentRow.IsNew&&this.addRows(d))}var e=!1,d=function(){this.setupGridControls(this.GridControls);this.setupFixedColumnProperties();this.setupGridComponents(this.GridComponents);this.setupGridUsercontrols(this.GridUserControls);this.triggerDatePickersSetup(this.DatePickersControls);this.installImageControls();this.isFreestyle&&this.loadRowsGrids(e);this.updateRcdCount();this.setDefaultEventHandlers()}.closure(this);this.grid.doSort();
!1==a?this.grid.render(e,!1,c,d):(e=!0,this.grid.render(e,b,c,d))};var u="gx-wc-bkp_"+v+"_"+s;this.getComponentsBackupContainer=function(){var a=gx.dom.el(u);a||(a=document.createElement("div"),a.id=u,a.style.display="none",document.body.appendChild(a));return a};this.destroyComponentsBackup=function(){var a=gx.dom.el(u);a&&a.parentNode&&gx.dom.removeControlSafe(a)};this.backupComponents=function(){try{for(var a=this.grid.rows.length,b=0;b<a;b++){for(var c=this.grid.rows[b],d=this.grid.columns.length,
e=0;e<d;e++)if(this.grid.columns[e].gxControl.type==gx.html.controls.types.webComponent){var f=this.gxComponentContext+"gxHTMLWrp"+this.parentObject.getComponentPrefix(c.gxProps[e][0])+c.gxId,i=gx.dom.el(f);i&&(i.parentNode.removeChild(i),this.getComponentsBackupContainer().appendChild(i))}for(var g=c.gxGrids.length,e=0;e<g;e++){var k=c.gxGrids[e];k&&k.isFreestyle&&k.backupComponents()}}}catch(j){gx.dbg.logEx(j,"gxgrid.js","backupComponents")}};this.getEntireGridColumn=function(a){var b=this.getContainerControl().firstChild,
c=[];if(b.querySelectorAll)c=gx.fn.toArray(b.querySelectorAll("td[colindex='"+a+"'], th[colindex='"+a+"']"));else{for(var d=gx.dom.byTag("TD",b),b=gx.dom.byTag("TH",b),e=0,f=d.length;e<f;e++)d[e].getAttribute("colindex")==a&&c.push(d[e]);e=0;for(f=b.length;e<f;e++)b[e].getAttribute("colindex")==a&&c.push(b[e])}return c};this.applyPropEntireColumn=function(a,b,c){for(var a=this.getEntireGridColumn(a),d=0;d<a.length;d++)gx.fn.setCtrlPropertyImpl(a[d],b,c)};this.setupFixedColumnProperties=function(){for(var a=
0;a<this.ColumnPropertiesAfterRender.length;a++){var b=this.ColumnPropertiesAfterRender[a];this.applyPropEntireColumn(b.colIndex,b.ptyName,b.ptyValue)}};this.addColPropertyAfterRender=function(a,b,c){this.ColumnPropertiesAfterRender.push({colIndex:a,ptyName:b,ptyValue:c})};this.setupGridControls=function(a){for(var b=0,c=a.length;b<c;b++){var d=a[b],e=gx.dom.el(d.hookId),f=e.parentNode;f&&(f.insertBefore(d.el,e),gx.dom.removeControlSafe(e))}};this.setupGridComponents=function(a){for(var b=a.length,
c=0;c<b;c++){var d=a[c];if(!1===d.create){var e=gx.dom.el(d.existingEl),f=e.parentNode,d=gx.dom.el(d.el);gx.dom.removeControlSafe(e);f.appendChild(d)}else gx.html.processCode(d.c,!1,function(a){var b=gx.createComponent(a.n,a.p);if(b!=null){gx.addComponent(b);b.readServerVars();if(a.load)b.onload()}},[d])}this.destroyComponentsBackup()};this.setupGridUsercontrols=function(a){for(var b=a.length,c=0;c<b;c++){var d=a[c].r,e=a[c].c,d=gx.uc.getNew(this.parentObject,e.gxUCId,e.gxUCLastId,e.gxUCClassName,
e.gxUCContainerName+"_"+d,e.gxUCControlName,this.gridLvl,this.gridId,d);d.DesignContainerName=e.gxUCContainerName;d.setC2ShowFunction(e.gxShowFunc);for(var f=e.gxC2VFuncs.length,i=0;i<f;i++)d.addC2VFunction(e.gxC2VFuncs[i]);f=e.gxV2CFuncs.length;for(i=0;i<f;i++)d.addV2CFunction(e.gxV2CFuncs[i]);d.setGridProperties();d.setGridEventHandlers();this.parentObject.setUserControl(d);d.execV2CFunctions(!0);d.execShowFunction()}};this.triggerDatePickersSetup=function(a){for(var b=a.length,c=0;c<b;c++){for(var d=
a[c].CtrlId,e=a[c].Grid,f=a[c].Row,i=gx.O,g=null,k=gx.fn.controlIds(),j=k.length,h=0;h<j&&!(g=gx.fn.validStruct(k[h]),g.grid==e&&i.CmpContext+g.fld+"_"+f==d);h++);null!=g&&void 0!=g.dp&&gx.fn.installDatePicker(d,g.dp.f,g.dp.st,g.dp.wn,g.dp.mf,gx.fn.datePickerFormat(g.dp.pic,g.dp.dec,g.len))}};this.installImageControls=function(){for(var a=gx.dom.byClass("gx-multimedia-upload","",this.gxContainerCtrl),b=0,c=a.length;b<c;b++)gx.html.multimediaUpload.createControl(a[b])};this.addComponentToDraw=function(a){this.GridComponents.push(a)};
this.addUsercontrolToDraw=function(a){this.GridUserControls.push(a)};this.addDatepickerToSetup=function(a){this.DatePickersControls.push(a)};this.addControlToReuse=function(a){a.el.parentNode&&gx.dom.removeControlSafe(a.el);this.GridControls.push(a)};this.loadRowsGrids=function(a){for(var b=this.grid.rows.length,c=0;c<b;c++)this.loadRowGrids(this.grid.rows[c],a)};this.loadRowGrids=function(a,b){for(var c=a.gxGrids.length,d=0;d<c;d++){var e=a.gxGrids[d];e.grid.setContainerDelayed(gx.dom.el(e.gxContainerDivName));
if(b){if(void 0!=e.parentRow&&!gx.lang.emptyObj(e.parentRow.Grids)){var f=e.getDataHiddenName();gx.fn.setHidden(f,e.parentRow.Grids[e.realGridName])}e.loadGrid()}else e.refreshGrid();a.IsNew=!1}};this.updateRcdCount=function(){(this.hasForEachLine||this.parentObject.isTransaction())&&gx.fn.setHidden(this.grid.gxCmpContext+"nRC_"+this.gridName,this.lastRowId.toString());var a=gx.fn.getHidden(this.grid.gxCmpContext+this.gridName.toUpperCase()+"_ROW");parseInt(a,10)>this.lastRowId&&this.grid.instanciateSelectionVars("0000")};
this.updateControlValue=function(a,b){try{var c=this,d=gx.fn.currentGridRow(a.grid).toString(),e=d,f=d.length;if(4<f){var g=d.substring(4,f),c=gx.fn.gridObj(this.gxComponentContext,this.gridName+"_"+g,this.isMasterPageGrid);if(!c)return;e=d.substring(0,4)}var j=parseInt(e,10)-1;!0==b&&c.setRowModified(d);var k=c.getColumnIndexByName(a.fld),m=gx.dom.el(this.gxComponentContext+a.fld+"_"+d);c.updateRowValue(k,j,m);return c}catch(h){gx.dbg.logEx(h,"gxgrid.js","updateControlValue")}return null};this.persistControlValue=
function(a,b,c){var d=a.lastIndexOf("_");if(-1!=d){var e=a.substring(0,d);if(d=this.grid.getRowByGxId(a.substring(d+1)))if(e=this.grid.getColumnByHtmlName(e)){var f=this.parentObject[c.gxvar];"decimal"==c.type&&gx.lang.instanceOf(f,Number)&&(f=f.toFixed(c.dec));d.values[e.index]=f;d.gxProps[e.index]||(d.gxProps[e.index]={});if((a=gx.dom.el(a))&&"SELECT"==a.tagName)d.gxProps[e.index].Values=gx.dom.comboBoxToObj(a);d.gxProps[e.index].Value=f;d.gxProps[e.index].FormattedValue=b}}};this.getColumnIndexByName=
function(a){for(var b=this.grid.columns,c=b.length,d=0;d<c;d++)if(b[d].htmlName==a)return d;return-1};this.setRowModified=function(a){gx.fn.setHidden(this.grid.gxCmpContext+"nIsMod_"+this.gridLvl.toString()+"_"+a,1);null!=this.parentGrid&&this.parentGrid.setRowModified(this.grid.gxParentRowId);this.grid.showDeleteImage(a)};this.validateRow=function(a){if(a)try{gx.fn.setCurrentGridRow(a.gxgridid,a.gxrow);var b=gx.fn.lastGridControl(a.gxgridid);gx.csv.validControls(gx.csv.lastId,b+1,!0)}catch(c){gx.dbg.logEx(c,
"gxgrid.js","validateRow")}};this.updateRowValue=function(a,b,c){var b=this.grid.getRowById(b),d=this.grid.columns[a];"checkbox"==c.type&&(c.value=c.checked?d.gxChecked:d.gxUnChecked);var e=gx.fn.getControlValue(this.grid.columns[a].htmlName+"_"+b.gxId),c=this.parentObject.getValidStruct(this.grid.columns[a].gxId).val();b.values[a]=c;gx.lang.emptyObject(b.gxProps[a])||(b.gxProps[a].Value=c,b.gxProps[a].FormattedValue=e);this.parentObject.isTransaction()&&(a=this.columnIndexInKey(d.gxAttId),-1!=a&&
(b.gxKeyValues[a]=c));d.gxControl.type==gx.html.controls.types.blob&&gx.fn.setControlValue(this.grid.gxCmpContext+d.htmlName+"_"+b.gxId+"_gxBlob",c)};this.expandCollapse=function(a,b){gx.evt.cancel(b,!0);var c=gx.dom.el(this.gxComponentContext+this.containerName+"Tbl");null!=c&&(this.collapsed?(c.style.display="block",a.src=gx.ajax.getImageUrl(gx,"collapseImage")):(c.style.display="none",a.src=gx.ajax.getImageUrl(gx,"expandImage")),this.collapsed=!this.collapsed,this.grid.gxCollapsed=this.collapsed,
this.parentGrid?(c=this.gridName.substring(this.gridName.lastIndexOf("_")),c=this.gxComponentContext+this.realGridName.toUpperCase()+"_Collapsed"+c):c=this.gxComponentContext+this.realGridName.toUpperCase()+"_Collapsed",gx.fn.setHidden(c,this.collapsed?"1":"0"))};this.getRowFromHtmlCtrl=function(a){var b=a.gxrow;gx.lang.emptyObject(b)&&(b=a.id.lastIndexOf("_"),b=a.id.substring(b+1));return this.grid.getRowByGxId(b)};this.showContextMenu=function(a,b){this.contextMenu.show(a,b)}},contextMenu:function(l){this.gxgrid=
l;this.controlName=this.gxgrid.containerName+"ContextMenu";this.eventSource=this.contextEvent=this.rowClicked=null;var o=new gx.text.stringBuffer;this.show=function(g,l){this.gxgrid.validateRow(g);this.contextEvent=l;this.eventSource=gx.evt.source(this.contextEvent);gx.evt.cancel(l,!0);this.rowClicked=g;this.startMenu();o.append('<div class="').append("menuItem").append('" id="').append("deleteRow").append('" align="center">').append(gx.getMessage("GXM_deleterow")).append("</div>");this.endMenu()};
this.startMenu=function(){o.clear();var g=this.getMenuCoords();o.append('<div onclick="').append(this.gxgrid.grid.gridObject()+".contextMenu.contextMenuClicked(event);").append('" onmouseover="');o.append(this.gxgrid.grid.gridObject()+".contextMenu.switchContextMenu();").append('" onmouseout="').append(this.gxgrid.grid.gridObject()+".contextMenu.switchContextMenu();").append('" oncontextmenu="gx.evt.cancel(event, true);');o.append('" style="').append("position:absolute;width:100;background-Color:menu; border: outset 1px gray;");
o.append("top:"+g.top+"; left:"+g.left+";").append('">')};this.endMenu=function(){o.append("</div>");var g=gx.dom.byId(this.controlName);null==g&&(g=document.createElement("SPAN"),ContextControlShadow=document.createElement("SPAN"),ContextControlShadow2=document.createElement("SPAN"),IFrameControl=document.createElement("IFRAME"),g.id=this.controlName,ContextControlShadow.id=this.controlName+"Shadow",ContextControlShadow2.id=this.controlName+"Shadow2",IFrameControl.id=this.controlName+"GXiFrameIEHack",
IFrameControl.src="about:blank",IFrameControl.style.zIndex=1,IFrameControl.style.visibility="hidden",IFrameControl.style.position="absolute",IFrameControl.frameBorder="0",document.body.appendChild(g),document.body.appendChild(ContextControlShadow),document.body.appendChild(ContextControlShadow2),document.body.appendChild(IFrameControl));gx.dom.shouldPurge()&&gx.dom.purge(g,!0);g.innerHTML=o.toString()};this.hide=function(){this.contextEvent=this.rowClicked=null;gx.dom.removeControl(gx.dom.byId(this.controlName))};
this.getMenuCoords=function(){var g=0,l=0,o=this.contextEvent;if(o.pageX||o.pageY)g=o.pageX,l=o.pageY;else if(o.clientX||o.clientY)g=o.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,l=o.clientY+document.body.scrollTop+document.documentElement.scrollTop;return{left:g,top:l}};this.contextMenuClicked=function(g){this.handleContextMenuAction(gx.evt.source(g).id);this.hide()};this.handleContextMenuAction=function(g){switch(g){case "deleteRow":this.gxgrid.setRowDeleted(this.rowClicked);
break;case "undeleteRow":this.gxgrid.setRowDeleted(this.rowClicked)}};this.switchContextMenu=function(){}},rowId:function(l){for(l=l.toString();4>l.length;)l="0"+l;return l},_init:function(){this.deleteMethod||(this.deleteMethod=this.deleteMethods.images);this.deleteImage=this.deleteImage&&this.deleteMethod==this.deleteMethods.images?gx.ajax.getImageUrl(this,"deleteImage"):gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"delete_16x.jpg",!0);this.undeleteImage=this.undeleteImage&&this.deleteMethod==
this.deleteMethods.images?gx.ajax.getImageUrl(this,"undeleteImage"):this.deleteImage;this.deletePosition||(this.deletePosition=this.deletePositions.left);this.deletePositionFree||(this.deletePositionFree=this.deletePositions.topL);this.deleteTooltip=this.deleteTooltip?gx.getMessage(this.deleteTooltip):"";this.deleteTitle=this.deleteTitle?gx.getMessage(this.deleteTitle):""},_deinit:function(){this.lastFocusCtrl=null}};
