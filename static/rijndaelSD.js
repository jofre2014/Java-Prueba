gx.sec.rijndael={keySizeInBits:128,blockSizeInBits:128,roundsArray:[,,,,[,,,,10,,12,,14],,[,,,,12,,12,,14],,[,,,,14,,14,,14]],shiftOffsets:[,,,,[,1,2,3],,[,1,2,3],,[,1,3,4]],Rcon:[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],SBox:[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,
226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,
221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],SBoxInverse:[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,
108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,
201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],cyclicShiftLeft:function(a,c){var b=a.slice(0,c);return a=a.slice(c).concat(b)},xtime:function(a){a<<=1;return a&256?a^283:a},mult_GF256:function(a,c){var b,d=0;for(b=1;256>b;b*=2,c=this.xtime(c))a&b&&(d^=c);return d},byteSub:function(a,c){var b;b="encrypt"==c?this.SBox:this.SBoxInverse;for(var d=0;4>d;d++)for(var e=0;e<this.Nb;e++)a[d][e]=b[a[d][e]]},shiftRow:function(a,c){for(var b=
1;4>b;b++)a[b]="encrypt"==c?this.cyclicShiftLeft(a[b],this.shiftOffsets[this.Nb][b]):this.cyclicShiftLeft(a[b],this.Nb-this.shiftOffsets[this.Nb][b])},mixColumn:function(a,c){for(var b=[],d=0;d<this.Nb;d++){for(var e=0;4>e;e++)b[e]="encrypt"==c?this.mult_GF256(a[e][d],2)^this.mult_GF256(a[(e+1)%4][d],3)^a[(e+2)%4][d]^a[(e+3)%4][d]:this.mult_GF256(a[e][d],14)^this.mult_GF256(a[(e+1)%4][d],11)^this.mult_GF256(a[(e+2)%4][d],13)^this.mult_GF256(a[(e+3)%4][d],9);for(e=0;4>e;e++)a[e][d]=b[e]}},addRoundKey:function(a,
c){for(var b=0;b<this.Nb;b++)a[0][b]^=c[b]&255,a[1][b]^=c[b]>>8&255,a[2][b]^=c[b]>>16&255,a[3][b]^=c[b]>>24&255},keyExpansion:function(a){var c=[];this.Nk=this.keySizeInBits/32;this.Nb=this.blockSizeInBits/32;this.Nr=this.roundsArray[this.Nk][this.Nb];for(var b=0;b<this.Nk;b++)c[b]=a[4*b]|a[4*b+1]<<8|a[4*b+2]<<16|a[4*b+3]<<24;for(b=this.Nk;b<this.Nb*(this.Nr+1);b++)a=c[b-1],0==b%this.Nk?a=(this.SBox[a>>8&255]|this.SBox[a>>16&255]<<8|this.SBox[a>>24&255]<<16|this.SBox[a&255]<<24)^this.Rcon[Math.floor(b/
this.Nk)-1]:6<this.Nk&&4==b%this.Nk&&(a=this.SBox[a>>24&255]<<24|this.SBox[a>>16&255]<<16|this.SBox[a>>8&255]<<8|this.SBox[a&255]),c[b]=c[b-this.Nk]^a;return c},Round:function(a,c){this.byteSub(a,"encrypt");this.shiftRow(a,"encrypt");this.mixColumn(a,"encrypt");this.addRoundKey(a,c)},InverseRound:function(a,c){this.addRoundKey(a,c);this.mixColumn(a,"decrypt");this.shiftRow(a,"decrypt");this.byteSub(a,"decrypt")},FinalRound:function(a,c){this.byteSub(a,"encrypt");this.shiftRow(a,"encrypt");this.addRoundKey(a,
c)},InverseFinalRound:function(a,c){this.addRoundKey(a,c);this.shiftRow(a,"decrypt");this.byteSub(a,"decrypt")},encrypt:function(a,c){var b;if(a&&8*a.length==this.blockSizeInBits&&c){a=this.packBytes(a);this.addRoundKey(a,c);for(b=1;b<this.Nr;b++)this.Round(a,c.slice(this.Nb*b,this.Nb*(b+1)));this.FinalRound(a,c.slice(this.Nb*this.Nr));return this.unpackBytes(a)}},decrypt:function(a,c){var b;if(a&&8*a.length==this.blockSizeInBits&&c){a=this.packBytes(a);this.InverseFinalRound(a,c.slice(this.Nb*this.Nr));
for(b=this.Nr-1;0<b;b--)this.InverseRound(a,c.slice(this.Nb*b,this.Nb*(b+1)));this.addRoundKey(a,c);return this.unpackBytes(a)}},byteArrayToString:function(a){for(var c="",b=a.length,d=0;d<b;d++)0!=a[d]&&(c+=String.fromCharCode(a[d]));return c},stringToByteArray:function(a){for(var c=[],b=a.length,d=0;d<b;d++)c[c.length]=a.charCodeAt();return c},byteArrayToHex:function(a){var c="";if(a){for(var b=a.length,d=0;d<b;d++)c+=(16>a[d]?"0":"")+a[d].toString(16);return c}},hexToByteArray:function(a){var c=
[];if(!(a.length%2)){if(0==a.indexOf("0x")||0==a.indexOf("0X"))a=a.substring(2);for(var b=a.length,d=0;d<b;d+=2)c[Math.floor(d/2)]=parseInt(a.slice(d,d+2),16);return c}},packBytes:function(a){var c=[];if(a&&!(a.length%4)){c[0]=[];c[1]=[];c[2]=[];c[3]=[];for(var b=a.length,d=0;d<b;d+=4)c[0][d/4]=a[d],c[1][d/4]=a[d+1],c[2][d/4]=a[d+2],c[3][d/4]=a[d+3];return c}},unpackBytes:function(a){for(var c=[],b=a[0].length,d=0;d<b;d++)c[c.length]=a[0][d],c[c.length]=a[1][d],c[c.length]=a[2][d],c[c.length]=a[3][d];
return c},formatPlaintext:function(a){var c=this.blockSizeInBits/8,b;if("string"==typeof a||a.indexOf){var a=a.split(""),d=a.length;for(b=0;b<d;b++)a[b]=a[b].charCodeAt(0)&255}for(b=c-a.length%c;0<b&&b<c;b--)a[a.length]=0;return a},getRandomBytes:function(a){var c,b=[];for(c=0;c<a;c++)b[c]=Math.round(255*Math.random());return b},rijndaelEncrypt:function(a,c,b){var d,e,h=this.blockSizeInBits/8,f;if(a&&c&&8*c.length==this.keySizeInBits){"CBC"==b?f=this.getRandomBytes(h):(b="ECB",f=[]);for(var a=this.formatPlaintext(a),
c=this.keyExpansion(c),g=0;g<a.length/h;g++){e=a.slice(g*h,(g+1)*h);if("CBC"==b)for(d=0;d<h;d++)e[d]^=f[g*h+d];f=f.concat(this.encrypt(e,c))}return f}},rijndaelDecrypt:function(a,c,b){var d=this.blockSizeInBits/8,e=[],h,f;if(a&&(c&&"string"!=typeof a)&&8*c.length==this.keySizeInBits){b||(b="ECB");c=this.keyExpansion(c);for(f=a.length/d-1;0<f;f--)if(h=this.decrypt(a.slice(f*d,(f+1)*d),c),"CBC"==b)for(var g=0;g<d;g++)e[(f-1)*d+g]=h[g]^a[(f-1)*d+g];else e=h.concat(e);"ECB"==b&&(e=this.decrypt(a.slice(0,
d),c).concat(e));return e}},_init:function(){this.Nk=this.keySizeInBits/32;this.Nb=this.blockSizeInBits/32;this.Nr=this.roundsArray[this.Nk][this.Nb]}};
