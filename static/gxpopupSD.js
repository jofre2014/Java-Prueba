gx.popup=function(){return{lvl:-1,currentPopup:null,currentPrompt:null,showParentPopups:!1,Dialog:function(){this.id="";this.autoresize=1;this.left=this.top=this.position=this.height=this.width=0;this.zindex=1E3;this.lvl=-1;this.InternalPopup=this.Opener=this.document=this.window=this.parentPopup=null;this.state="created";this.callbacks={};this.open=function(a){this.state="opening";this.id=a.id||"gxdialog";this.callbacks=a.callbacks;gx.popup.ext.window(this,!1,0,0,a.w,a.h,a.contentHtml,"white",a.title,
"black","black","black","black",!0,!0,!0,!0,!1,gx.ajax.getImageUrl(gx,"resizeImage"),"PopupHeader","PopupHeaderButton","PopupContent","PopupBorder","PopupShadow",a.showParentPopups,!1,a.callbacks,a.parentElement);gx.popup.ext.win.gx.popup.setPopup(this);this.state="opened"};this.close=function(){this.state="closing";gx.popup.ext.close(this,this.callbacks.beforeClose);this.cleanup();this.state="closed"};this.cleanup=function(){delete this.InternalPopup;delete this.window;delete this.document;delete this.Opener;
delete this.parentPopup;delete this.InternalPopup;delete this.callbacks};this.isActive=function(){return!("closed"==this.state||"closing"==this.state)};this.getEl=function(){return gx.dom.byId(this.id+"_b")}},Popup:function(a,b){this.url="";this.frameWindow=this.frameDocument=null;this.ReturnParms=[];this.RawReturnedParms=[];this.ModifCtrl=null;this.IsPrompt=b?b:!1;this.PromptIsGet=!1;this.OncloseCmds=[];this.CustomRenderGrid=null;this.setPopupData=function(){if(gx.lang.isArray(a))this.url=a[0],this.autoresize=
a[1],this.width=a[2],this.height=a[3],this.position=a[4],this.top=a[5],this.left=a[6],this.OncloseCmds=a[7]||[],this.ReturnParms=a[8]||[];else if(a&&a.Url&&(this.url=a.Url,"undefined"!=typeof a.Autoresize&&(this.autoresize=a.Autoresize),"undefined"!=typeof a.Width&&(this.width=a.Width),"undefined"!=typeof a.Height&&(this.height=a.Height),"undefined"!=typeof a.Position&&(this.position=a.Position),"undefined"!=typeof a.Top&&(this.top=a.Top),"undefined"!=typeof a.Left&&(this.left=a.Left),"undefined"!=
typeof a.OncloseCmds&&(this.OncloseCmds=a.OncloseCmds),"undefined"!=typeof a.ReturnParms))this.ReturnParms=a.ReturnParms};this.open=function(){this.state="opening";var a=gx.popup.gxOpener();this.lvl=-1;this.lvl=a&&a.gx&&a.gx.popup.ext.win&&a.gx.popup.ext.win.gx?a.gx.popup.ext.win.gx.popup.lvl:gx.popup.lvl;null!=document.gxPopup?(this.parentPopup=document.gxPopup,this.zindex=gx.popup.ext.zdx+document.gxPopup.zindex):this.zindex=gx.popup.ext.zdx;a=this.url;if(this.IsPrompt){gx.popup.currentPrompt=this;
for(var c="?",b="",f="",h=this.ReturnParms.length,g=0;g<h;g++){if(gx.lang.emptyObject(this.ReturnParms[g].Ctrl))if("string"==typeof this.ReturnParms[g])b=gx.util.urlValue(this.ReturnParms[g])+",";else if("number"==typeof this.ReturnParms[g])b=gx.util.urlValue(this.ReturnParms[g].toString())+",";else if(this.CustomRenderGrid)f=this.CustomRenderGrid.grid.getCellValue(this.ReturnParms[g].id),gx.lang.emptyObject(f)||(b=gx.util.urlValue(f+"")+",");else if(gx.lang.emptyObject(this.ReturnParms[g].id))continue;
else f=gx.fn.getHidden(this.ReturnParms[g].id),gx.lang.emptyObject(f)||(b=gx.util.urlValue(f)),b+=",";else b=gx.util.urlValue(this.ReturnParms[g].Ctrl)+",";c="out"==this.ReturnParms[g].IOType?c+",":c+b;this.ReturnParms[g].isLastKey&&(gx.fn.isOutputParm(this.ReturnParms[g])&&!this.PromptIsGet)&&(gx.fn.setControlValue("_EventName",this.Opener.CmpContext),this.PromptIsGet=!0)}null!=this.ModifCtrl&&(this.ModifCtrl.value=1);a+=c}c=document.activeElement;c==document.body&&gx.csv.lastControl&&(c=gx.csv.lastControl);
c&&(c&&(this.callerActiveElement=c),c.blur&&c.blur());this.InternalPopup=gx.popup.Impl(this,a,this.autoresize,this.width,this.height,this.position,this.top,this.left)};this.getOutputParms=function(){var a=[];if(this.IsPrompt)for(var b=this.ReturnParms.length,e=0;e<b;e++){var f=this.ReturnParms[e];gx.fn.isOutputParm(f)&&a.push(f)}else return this.ReturnParms;return a};this.close=function(a){var b;this.state="closing";a&&(this.RawReturnedParms=a);gx.popup.ext.win?(gx.ajax.windowClosed(gx.popup.ext.win.gx.popup.lvl),
gx.popup.ext.win.gx.popup.lvl--):(gx.ajax.windowClosed(gx.popup.lvl),gx.popup.lvl--);!gx.popup.ext.isPdf&&(this.frameWindow&&this.frameWindow.gx)&&(this.IsPrompt&&(null==this.parentPopup?gx.popup.currentPrompt=null:this.parentPopup.frameWindow.gx.popup.currentPrompt=null),this.frameWindow.gx.evt.onunload.call(this.frameWindow),this.frameWindow=this.frameDocument=this.frameDocument.gxPopup=null);gx.popup.ext.close(this);var e=this.getOutputParms();if(null!=a&&this.IsPrompt){var f=a.length,h=gx.popup.assignPromptField,
g=gx.popup;gx.lang.emptyObject(this.CustomRenderGrid)||(h=this.CustomRenderGrid.grid.setCellValue,g=this.CustomRenderGrid.grid);for(b=0;b<f;b++)h.apply(g,[e[b],a[b]]);a=null;f=e.length;for(b=0;b<f;b++)h=e[b].Ctrl,gx.fn.isAccepted(h)&&(a=h);a&&gx.TabOnPrompSelect&&(b=gx.fn.getControlIndex(a),-1!=b&&(a=gx.fn.searchFocus(b+1,!0)));gx.fn.setFocus(a);if(this.PromptIsGet)gx.csv.loadScreen(),gx.fn.setFocus(a);else try{gx.evt.ctrlOnchange(gx.fn.getControlValue(this.Opener.CmpContext+"Mode"),gx.fn.getControlValue(this.Opener.CmpContext+
"IsConfirmed"),"undefined"==typeof window.GXPkIsDirty?!1:window.GXPkIsDirty,null,"eng")}catch(i){gx.dbg.logEx(i,"gxpopup.js","close")}}else a&&e&&(e instanceof Array&&0<e.length)&&gx.fn.setReturnParms(this.Opener,e,a);gx.ajax.dispatchCommands(this.OncloseCmds);this.cleanup();this.state="closed"};this.setFocusFirst=function(){this.frameWindow.gx&&this.frameWindow.gx.fn.setFocusOnload()};this.cleanup=function(){try{this.OncloseCmds=[],this.ReturnParms=[],this.PromptIsGet=!1,this.parentPopup=this.Opener=
this.document=this.window=this.InternalPopup=null,this.RawReturnedParms=[],this.CustomRenderGrid=this.InternalPopup=this.ModifCtrl=null}catch(a){gx.dbg.logEx(a,"gxpopup.js","popupObj.cleanup")}};this.setPopupData()},gxOpener:function(){var a=null;try{parent.gxTestAvailable=1,a=parent}catch(b){}return a},setFocus:function(){var a=this.getPopup();a&&a.window.frames[0].focus()},ispopup:function(){return null!=this.getPopup()},popupurl:function(){return this.getPopup().url},waitCallback:function(a){var b=
gx.popup.getPopup();b?"opened"==b.state?a():gx.lang.doCallTimeout(gx.popup.waitCallback,gx.popup,[a],50):a()},getPopup:function(){var a=this.gxOpener();try{if(!gx.lang.emptyObject(a)&&!gx.lang.emptyObject(a.gx))return a.gx.popup.currentPopup}catch(b){}return null},setPopup:function(a){this.currentPopup=a},open:function(a){return this.openPopup(a)},openUrl:function(a,b,d){var c=1,e=0,f=0,h=0,g=0,i=0;d&&(c=d[0],e=d[1],f=d[2],h=d[3],g=d[4],i=d[5]);return this.openPopup([a,c,e,f,h,g,i,[],b])},openPopup:function(a){a=
new this.Popup(a,!1);a.Opener=gx.O;a.open();return a},openDialog:function(a){var b=new this.Dialog;b.Opener=gx.O;b.open(a);return b},openPrompt:function(a,b,d,c,e,f){if(null==gx.popup.currentPrompt){var h=b[0].Ctrl,g=!1,i,k;if(h)i=gx.fn.rowGridId(h),h=gx.fn.controlRowId(h),!gx.lang.emptyObject(i)&&!gx.lang.emptyObject(h)&&(gx.csv.lastGrid=i,gx.fn.setCurrentGridRow(i,h));else if(i=gx.O.getValidStructFld(b[0].id),!gx.lang.emptyObject(i)&&(k=gx.O.getGridById(i.grid)))if(g=k.isUsercontrol)i=k.gridId+
"",h=!gx.lang.emptyObject(k.grid.getSelectedRow)?gx.text.padl(k.grid.getSelectedRow()+"",4,"0"):void 0,!gx.lang.emptyObject(i)&&!gx.lang.emptyObject(h)&&(gx.csv.lastGrid=i,gx.fn.setCurrentGridRow(i,h));if(f||this.outParmsAccepted(b)||g)a=new this.Popup([a,1,0,0,0,0,0,[],b],!0),a.IsMod=d,a.Opener=gx.getObj(c,e),a.CustomRenderGrid=k,a.open()}},outParmsAccepted:function(a){for(var b=a.length,d=!1,c=0;c<b;c++){var e=a[c];gx.fn.isOutputParm(e)&&(d=!0);if(gx.fn.isOutputParm(e)&&e.Ctrl&&gx.fn.isAccepted(e.Ctrl))return!0}return!d},
gxReturn:function(a){gx.fn.closeWindow(a)},parmId:function(a){a=gx.dom.id(a);0===a.indexOf("span_")&&(a=a.substring(5));return a},popuplvl:function(){var a=gx.popup.getPopup();return!a||!a.window?-1:a.window.gx.popup.lvl},assignPromptField:function(a,b){if(!gx.lang.emptyObject(a)&&(gx.csv.pkDirty=a.isKey,a.Ctrl)){"checkbox"==a.Ctrl.type&&a.Ctrl.value!=b&&(a.Ctrl.checked=!a.Ctrl.checked);a.Ctrl.value!=b&&a.isKey&&(gx.popup.gxOpener().GXPkIsDirty=!0);var d=gx.csv.ctxControlId(this.parmId(a.Ctrl)),c=
gx.O.getValidStructFld(d),e;if(!gx.lang.emptyObject(c)&&(e=gx.O.getValidStructId(c.fld)))e>gx.O.toValid&&(gx.O.toValid=e),gx.csv.validateAll();!gx.lang.emptyObject(c)&&!gx.lang.emptyObject(c.v2c)&&("date"==c.type||"dtime"==c.type)?(c.v2v(b),c.v2c()):gx.fn.setControlValue(this.parmId(a.Ctrl),b,0);a.Ctrl.setAttribute("gxvalid","0");gx.evt.execOnchange(a.Ctrl);var f=gx.dom.byId("span_"+a.Ctrl.name);null!=f&&(0===f.childNodes.length&&f.appendChild(gx.popup.gxOpener().document.createTextNode("")),f.childNodes[0].nodeValue=
b);c&&c.gxgrid&&c.gxgrid.updateControlValue(c,!1);gx.util.balloon.clear(d);e&&(gx.O.toValid=e,gx.csv.validateAll())}},autofit:function(){var a=this.getPopup();!gx.lang.emptyObject(a)&&"opened"==a.state&&this.ext.autofit(a,null,!1)},Impl:function(a,b,d,c,e,f,h,g){return new this.ext.popUp(a,d,f,g,h,c,e,"gxp",b,"white","#00385c","16pt serif","GxPopup","#00385c","white","lightgrey","#00568c","black",!0,!1,!0,!0,!0,!0,!1,"min.gif","max.gif","close.gif",gx.ajax.getImageUrl(gx,"resizeImage"),"PopupHeader",
"PopupHeaderButton","PopupContent","PopupBorder","PopupShadow",void 0)},setZIndex:function(a){a=gx.dom.getStyle(a,"zIndex");isNaN(a)&&(a=999);a++;this.zindex=a;this.ext.zdx=a},ext:{w3c:gx.util.browser.w3c,ns4:gx.util.browser.ns4,ie5:gx.util.browser.ie5,ns6:gx.util.browser.ns6,isFF:gx.util.browser.isFirefox(),currIDb:null,xoff:0,yoff:0,currRS:null,rsxoff:0,rsyoff:0,zdx:1E3,sdiff:5,win:null,doc:null,hide:function(a){if(this.w3c){var b=gx.dom.byId;b(a+"_t").style.visibility="hidden";b(a+"_c").style.visibility=
"hidden";b(a+"_rs").style.visibility="hidden";b(a+"_b").style.visibility="hidden";b(a+"_s").style.visibility="hidden"}},show:function(a){var b=gx.dom.byId;b(a+"_t").style.visibility="visible";b(a+"_c").style.visibility="visible";b(a+"_rs").style.visibility="visible";b(a+"_b").style.visibility="visible";b(a+"_s").style.visibility="visible"},close:function(a,b){if(!b||!("function"==typeof b&&!1===b())){gx.popup.ext.win=null;gx.popup.ext.doc=null;gx.popup.ext.currIDb=null;gx.popup.ext.currIDs=null;gx.popup.ext.currRS=
null;var d=a.id,c=document.getElementById(d+"_s"),e=document.getElementById(d+"_b");gx.dom.removeControlSafe(c);d=document.getElementById(d+"_ifrm");gx.popup.ext.deinitmodal(a);gx.popup.setPopup(a.parentPopup);(c=a.callerActiveElement)&&c.focus&&c.focus();a.parentPopup?a.parentPopup.frameWindow.gx.fx.obs.notify("popup.close",[a]):gx.fx.obs.notify("popup.close",[a]);d&&(d.src=gx.util.getIFrameEmptySrc());gx.util.browser.isIE()&&7==gx.util.browser.ieVersion()?e.parentNode.removeChild(e):gx.dom.removeControlSafe(e)}},
move:function(a,b,d){if(this.w3c){var c=gx.dom.byId,e=c(a+"_b"),f=c(a+"_c"),a=c(a+"_s");e.style.left=b+"px";a.style.left=b+this.sdiff+"px";e.style.top=d+"px";a.style.top=d+this.sdiff+"px";f.style.overflow="hidden"}},resize:function(a,b,d){if(this.w3c){var c=gx.dom.byId;if(c(a+"_rs").rsEnable){var e=c(a+"_extWA"),f=c(a+"_rs"),h=c(a+"_b"),g=c(a+"_t"),i=c(a+"_s"),a=c(a+"_c"),c=this.ie5;e.style.display="block";f.style.left=Math.max(b,c?88:92)+"px";f.style.top=Math.max(d,c?68:72)+"px";h.style.width=Math.max(b+
(c?12:8),100)+"px";h.style.height=Math.max(d+(c?12:8),80)+"px";g.style.width=Math.max(b+(c?4:3),this.ns6?95:92)+"px";i.style.width=Math.max(b+12,c?100:104)+"px";i.style.height=Math.max(d+(c?12:13),c?80:86)+"px";a.style.width=Math.max(b-(c?-5:5),c?92:87)+"px";a.style.height=Math.max(d-(c?24:28),44)+"px";a.style.overflow="hidden"}}},ns6bugfix:function(){0<navigator.userAgent.indexOf("Netscape/6")&&setTimeout("self.resizeBy(0,1); self.resizeBy(0,-1);",100)},movepopup:function(){null!=this.currIDb&&this.w3c&&
this.move(this.currIDb.cid,gx.evt.mouse.x+this.xoff,gx.evt.mouse.y+this.yoff);null!=this.currRS&&this.w3c&&this.resize(this.currRS.cid,gx.evt.mouse.x+this.rsxoff,gx.evt.mouse.y+this.rsyoff);return!1},stopRS:function(a,b){document.getElementById(b.cid+"_extWA").style.display="none";gx.popup.ext.currRS=null},startRS:function(a,b){var d=gx.popup.ext,c=d.ie5?event.clientX+gx.dom.documentScroll().scrollLeft:a.pageX,e=d.ie5?event.clientY+gx.dom.documentScroll().scrollTop:a.pageY;d.rsxoff=parseInt(b.style.left,
0)-c;d.rsyoff=parseInt(b.style.top,0)-e;d.currRS=b;d.ns6&&(document.getElementById(b.cid+"_c").style.overflow="hidden");return!1},changez:function(a){var a=null!=a?a:this,b=gx.popup.ext,d=gx.dom.byId;b.ns6&&(d(a.cid+"_c").style.overflow="hidden");d(a.cid+"_s").style.zIndex=++b.zdx;a.style.zIndex=++b.zdx;d(a.cid+"_rs").style.zIndex=++b.zdx},stopdrag:function(a,b){var d=gx.popup.ext;d.currIDb=null;document.getElementById(b.cid+"_extWA").style.display="none";d.ns6bugfix()},grab_id:function(a,b){var d=
gx.popup.ext,c=gx.dom.byId;gx.evt.mouse.update(a);var e=gx.evt.mouse.x,f=gx.evt.mouse.y;d.xoff=parseInt(c(b.cid+"_b").style.left,0)-e;d.yoff=parseInt(c(b.cid+"_b").style.top,0)-f;d.currIDb=c(b.cid+"_b");d.currIDs=c(b.cid+"_s");c(b.cid+"_extWA").style.display="block";return!1},subBox:function(a,b,d,c,e,f){e=document.createElement("div");e.setAttribute("id",f);e.style.position="absolute";e.style.left=a+"px";e.style.top=b+"px";e.style.width=d+"px";e.style.height=c+"px";e.style.visibility="visible";e.style.padding=
"0px";return e},window:function(a,b,d,c,e,f,h,g,i,k,j,l,m,s,n,x,p,t,u,v,r,q,w,B,y,E,D,A){var y=void 0!==y?y:gx.popup.showParentPopups,o=a.id;this.win||(this.win=window);this.doc||(this.doc=this.win.document);var z=this.win.gx.dom.byId.closure(this.win.gx.dom),e=Math.max(e,100),f=Math.max(f,80),b=new this.subBox(e-(this.ie5?12:8),f-(this.ie5?12:8),7,7,"",o+"_rs");p&&(b.innerHTML='<img src="'+u+'" width="7" height="7">',b.style.cursor="se-resize");b.rsEnable=p;var u=this.ie5?e:e+4,C=this.ie5?f:f+6,
m=new this.subBox(d+this.sdiff,c+this.sdiff,u,C,m,o+"_s");m.className=B;this.ie5?m.style.filter="alpha(opacity=50)":m.style.MozOpacity=0.5;m.style.zIndex=++this.zdx;n||(m.style.visibility="hidden");d=new this.subBox(d,c,e,f,j,o+"_b");d.className=w;d.style.display="block";d.style.zIndex=++this.zdx;n||(d.style.visibility="hidden");u=this.ie5?e-8:e-5;C=this.ie5?f+4:f-4;w=new this.subBox(2,2,u,20,k,o+"_t");w.style.overflow="hidden";w.className=v;n||(w.style.visibility="hidden");w.innerHTML='<span id="'+
o+'_gxtitle" class="PopupTitle" style="white-space:nowrap;position:absolute;padding: 2px;">'+i+'</span><span class="'+r+'" style="z-index:'+ ++this.zdx+';" id="'+o+'_cls"></span>';u=this.ie5?e-7:e-13;e=new this.subBox(2,24,u,f-36,g,o+"_c");e.className=q;"string"==typeof h?e.innerHTML=h:e.appendChild(h);e.style.overflow="hidden";n||(e.style.visibility="hidden");n||(d.style.visibility="hidden");h=new this.subBox(2,24,0,0,"",o+"_extWA");h.style.display="none";h.style.width="100%";h.style.height="100%";
d.appendChild(w);d.appendChild(e);d.appendChild(h);d.appendChild(b);A=gx.dom.el(A)||this.doc.body;A.appendChild(m);A.appendChild(d);n||this.hide(o);n=z(o+"_b");n.cid=o;n.isExt=t?!0:!1;t=z(o+"_t");t.cid=o;p&&(p=z(o+"_rs"),p.cid=o,gx.evt.attach(p,"mousedown",this.startRS.closure(this,[p],!0)),gx.evt.attach(p,"mouseup",this.stopRS.closure(this,[p],!0)));p=z(o+"_cls");n.activecolor=k;n.inactivecolor=l;gx.evt.attach(p,"click",D.close||this.close.closure(this,[a,D.beforeClose]));x&&(gx.evt.attach(t,"mousedown",
this.grab_id.closure(this,[t],!0)),gx.evt.attach(t,"mouseup",this.stopdrag.closure(this,[t],!0)),gx.evt.attach(b.firstChild,"dragstart",function(a){gx.evt.cancel(a,true)},!0));(s||y)&&this.initmodal(a,y,E)},popUp:function(a,b,d,c,e,f,h,g,i,k,j,l,m,s,n,x,p,t,u,v,r,q,w,B,y,E,D,A,o,z,C,F,G,H,I){j=gx.popup.ext;null!=a.parentPopup?(l=a.parentPopup.window,j=l.gx.popup.ext,j.win=l,j.doc=l.document,gx.popup.ext=j):(j.win=window,j.doc=j.win.document);j.win.gx.popup.setPopup(a);a.window=j.win;a.document=j.doc;
j.win.gx.popup.lvl++;g+=j.win.gx.popup.lvl;a.id=g;!a.IsPrompt&&!gx.util.sameAppUrl(i)?(gx.popup.setPopup(null),a=new Date,a=a.getTime(),g="",1==d&&(g=j.ns4?"screenX="+c+",screenY="+e:"left="+c+",top="+e),c="",b||(c=",width="+f+",height="+h),window.open(B?i:"","gx"+a,"status=no,menubar=no"+c+",resizable="+(q?"yes":"no")+",scrollbars=yes,"+g)):(i+=-1!=i.indexOf("?")?",":"?",i+=encodeURIComponent("gxPopupLevel="+j.win.gx.popup.lvl+";"),i='<iframe id="'+g+'_ifrm" src="'+i+'" width="100%" height="100%" frameborder="0" '+
(gx.HTML5?"":'scrolling="off"')+' style="overflow:auto;"></iframe>',d={close:a.close.closure(a)},j.window(a,b,c,e,f,h,i,k,m,s,x,p,t,u,v,r,q,B,o,z,C,F,G,H,I,!0,d),b=j.win.gx.dom.el(g+"_ifrm"),gx.lang.doCallTimeout(j.showIfLoaded,j,[a,b,1],50))},initmodal:function(a,b,d){a.showParentPopups=b;null==a.parentPopup?gx.ajax.disableForm(d):b?(b=gx.http.notification.node(),a=gx.dom.el(a.id+"_b"),b&&a&&(b.style.zIndex=parseInt(a.style.zIndex,0)-1)):this.hide(a.parentPopup.id)},deinitmodal:function(a){if(null==
a.parentPopup)gx.ajax.enableForm();else{if(a.showParentPopups){var b=gx.http.notification.node(),d=gx.dom.el(a.parentPopup.id+"_b");b&&d&&(b.style.zIndex=parseInt(d.style.zIndex,0)-1)}this.show(a.parentPopup.id);(b=a.parentPopup.frameWindow)&&b.gx&&a.parentPopup.frameWindow.gx.ajax.enableForm()}},isPDF_IE:function(a){this.isPdf=!1;var b=a.src;if(gx.util.getContentTypeFromExt(b)==gx.util.contentTypes.pdf)return this.isPdf=!0;var d=!0;try{if(d=a.contentDocument,d=a.contentWindow.document,d.contentType==
gx.util.contentTypes.pdf)return this.isPdf=!0}catch(c){d=!1}if(!1===d){var e,a={};a.url=b;a.method="HEAD";a.sync=!0;a.handler=function(a,b,c){e=c.getResponseHeader("Content-Type")};a.obj=!0;gx.http.doCall(a);if(e&&0<=e.indexOf(gx.util.contentTypes.pdf))return this.isPdf=!0}return!1},showIfLoaded:function(a,b,d){try{if(a.isActive()&&(this.docReady(b,d)||10<d&&void 0===this.isPdf&&this.isPDF_IE(b))){var c=gx.dom.iFrameDoc(b),e=!1;try{e=c&&"about:blank"!=c.URL}catch(f){}var h=this.isPdf||this.isPDF_IE(b);
if(e||h){a.state="opened";this.autofit(a,c,!0);return}}}catch(g){gx.dbg.logEx(g,"gxpopup.js","showIfLoaded")}d++;gx.lang.doCallTimeout(gx.popup.ext.showIfLoaded,gx.popup.ext,[a,b,d],50*d)},docReady:function(a,b){if("complete"==a.readyState)return!0;var d=gx.dom.iFrameDoc(a);if(d){var c;try{c="undefined"!=typeof d.gxReadyState?d.gxReadyState:d.readyState}catch(e){return!0}if("complete"==c)return!0}return!gx.util.browser.isIE()&&10<=b&&d&&d.body&&0!==d.body.childNodes.length?!0:!1},autofit:function(a,
b,d){if(!gx.lang.emptyObject(a)){var c=document;a.zindex=null!=c.gxPopup?this.zdx+c.gxPopup.zindex:this.zdx;var e=a.id;this.doc||(this.doc=a.document);var c=this.doc,f=c.getElementById(e+"_ifrm");!b&&gx.popup.ispopup()&&(b=gx.dom.iFrameDoc(f));a.frameDocument=b;a.frameWindow=f.contentWindow;b&&!this.isPdf&&(b.gxPopup=a);var f=c.getElementById(e+"_rs"),h=c.getElementById(e+"_s"),g=c.getElementById(e+"_t"),i=c.getElementById(e+"_b"),k=c.getElementById(e+"_c"),j=c.getElementById(e+"_gxtitle"),l=parseInt(k.style.height,
0),m=parseInt(k.style.width,0),s,n,x,p,t=0,u=0;s=gx.util.getWindowInfo().canAccessFrame;j.innerHTML=b&&!this.isPdf?b.title:"";if(!s||window==window.top||gx.lang.emptyObject(window.top))s=window.innerWidth||c.documentElement.clientWidth||c.body.offsetWidth,n=window.innerHeight||c.documentElement.clientHeight||c.body.offsetHeight,x=gx.dom.documentScroll(c).scrollTop,p=gx.dom.documentScroll(c).scrollLeft;else{var v=gx.dom.position(window.frameElement);window.top.document.body.clientHeight>c.body.clientHeight?
n=c.body.clientHeight:(n=window.top.document.body.clientHeight,u=v.y);x=c.body.scrollTop;p=c.body.scrollLeft;s=Math.min(window.top.document.body.clientWidth,c.body.clientWidth);window.top.document.body.clientWidth>c.body.clientWidth?s=c.body.clientWidth:(s=window.top.document.body.clientWidth,t=v.x)}v=gx.dom.dimensions(i);a.autoresize||(l=a.height-l+v.h,m=a.width-m+v.w);var r=a.width-m,q=a.height-l;if(a.autoresize)if(!this.isPdf&&b&&b.body){r=b.body.scrollWidth+30-s;c=b.body.scrollHeight+30-n;q=0;
if(b.body.scrollWidth>s)var w=b.body.scrollWidth-b.body.clientWidth,q=q+(d&&0<w?w:0);r=Math.max(b.body.scrollWidth,j.clientWidth+15)-m-(0<r?r:0)+q;q=b.body.scrollHeight-l-(0<c?c:0)}else this.isPdf&&(r=c.body.clientWidth/2,q=c.body.clientHeight/2);b=parseInt(a.top,0);l=parseInt(a.left,0);if(!a.position&&(b=(n-q)/2-v.h/2+x-u,l=(s-r)/2-v.w/2+p-t,0>b&&(b=5,q-=5),0>l))l=5,r-=5;i.style.top=parseInt(b,0)+"px";i.style.left=parseInt(l,0)+"px";h.style.top=parseInt(b,0)+this.sdiff+"px";h.style.left=parseInt(l,
0)+this.sdiff+"px";a.autoresize?(a=function(a,b){var c=parseInt(a,0)+b;return c>0?c:a},g.style.width=a(g.style.width,r)+"px",i.style.height=a(i.style.height,q)+"px",i.style.width=a(i.style.width,r)+"px",k.style.height=a(k.style.height,q)+"px",k.style.width=a(k.style.width,r)+"px",g=gx.util.browser.isIE()?0:4,h.style.height=parseInt(i.style.height,0)+g+"px",h.style.width=parseInt(i.style.width,0)+g+"px",g=gx.util.browser.isIE()?4:2,f.style.top=parseInt(i.style.height,0)-parseInt(f.style.height,0)-
g+"px",f.style.left=parseInt(i.style.width,0)-parseInt(f.style.width,0)-g+"px"):(l=a.height,m=a.width,a=this.ie5,f.style.left=Math.max(m,a?88:92)+"px",f.style.top=Math.max(l,a?68:72)+"px",i.style.width=Math.max(m+(a?12:8),100)+"px",i.style.height=Math.max(l+(a?12:8),80)+"px",g.style.width=Math.max(m+(a?4:3),this.ns6?95:92)+"px",h.style.width=Math.max(m+12,a?100:104)+"px",h.style.height=Math.max(l+(a?12:13),a?80:86)+"px",k.style.width=Math.max(m-(a?-5:5),a?92:87)+"px",k.style.height=Math.max(l-(a?
24:28),44)+"px");gx.util.browser.isIPad()||gx.util.browser.isIPhone()?(k.style["overflow-y"]="auto",k.style["-webkit-overflow-scrolling"]="touch"):k.style.overflow="hidden";d&&this.show(e)}},_init:function(){this.w3c=gx.util.browser.w3c;this.ns4=gx.util.browser.ns4;this.ie5=gx.util.browser.ie5;this.ns6=gx.util.browser.ns6;setInterval(gx.popup.ext.movepopup.closure(gx.popup.ext),40)}},_init:function(){gx.lang.inherits(this.Popup,this.Dialog);this.ext._init();var a=this.getPopup();if(a){try{a.frameDocument&&
(a.frameDocument.gxPopup=a)}catch(b){a.frameDocument=a.frameWindow.document,gx.dbg.logEx(b,"gxpopup.js","_init")}a=a.window.gx.popup;gx.fx.obs.addObserver("gx.onload",a,function(){this.autofit()}.closure(a));gx.fx.obs.addObserver("grid.onafterrefresh",a,function(a,b,e){b<e&&this.autofit()}.closure(a));gx.fx.obs.addObserver("gx.onafterevent",a,function(){this.autofit()}.closure(a))}}}}();
